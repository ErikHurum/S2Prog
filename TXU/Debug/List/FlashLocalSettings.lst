##############################################################################
#                                                                            #
# IAR ARM ANSI C/C++ Compiler V4.42A/W32               14/Sep/2022  15:13:44 #
# Copyright 1999-2005 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Cpu mode        =  interwork                                            #
#    Endian          =  little                                               #
#    Stack alignment =  4                                                    #
#    Source file     =  D:\S2Prog\TXU\src\FlashLocalSettings.cpp             #
#    Command line    =  D:\S2Prog\TXU\src\FlashLocalSettings.cpp --fpu None  #
#                       -D OS_LIBMODE_SP -D CPU_S3C2410 -D OS_RAMVECT=0 -D   #
#                       OS_UART=-1 -D S2TXU -D USE_LZO=1 -D __ARM_LIBRARY__  #
#                       -D WATCHDOG=1 -D NETWORK=1 -lCN                      #
#                       D:\S2Prog\TXU\Debug\List\ -o                         #
#                       D:\S2Prog\TXU\Debug\Obj\ -s9 --debug --cpu_mode arm  #
#                       --endian little --cpu ARM920T --stack_align 4        #
#                       --interwork -e --enable_multibytes --eec++           #
#                       --dlib_config "C:\Program Files (x86)\IAR            #
#                       Systems\Embedded Workbench                           #
#                       4.0\arm\LIB\dl4tpainl8n.h" -I                        #
#                       D:\S2Prog\TXU\GUI\CORE\ -I D:\S2Prog\TXU\GUI\WM\ -I  #
#                       D:\S2Prog\TXU\GUI\WIDGET\ -I D:\S2Prog\TXU\CONFIG\   #
#                       -I D:\S2Prog\TXU\INC\ -I D:\S2Prog\TXU\..\SHARED\INC #
#                       \ -I D:\S2Prog\TXU\..\SHARED\SRC\ -I                 #
#                       D:\S2Prog\TXU\..\SHARED\LZO\minilzo.210\ -I          #
#                       D:\S2Prog\TXU\lwip-1.4.1\src\include\ -I             #
#                       D:\S2Prog\TXU\lwip-1.4.1\src\include\ipv4\ -I        #
#                       D:\S2Prog\TXU\lwip-1.4.1\src\ -I                     #
#                       D:\S2Prog\TXU\..\SHARED\Database\ -I                 #
#                       D:\S2Prog\TXU\src\ -I "C:\Program Files (x86)\IAR    #
#                       Systems\Embedded Workbench 4.0\arm\INC\"             #
#                       --inline_threshold=2                                 #
#    List file       =  D:\S2Prog\TXU\Debug\List\FlashLocalSettings.lst      #
#    Object file     =  D:\S2Prog\TXU\Debug\Obj\FlashLocalSettings.r79       #
#                                                                            #
#                                                                            #
##############################################################################

D:\S2Prog\TXU\src\FlashLocalSettings.cpp
      1          #include "TSNIncludes.h"
      2          #include "GUITouchConf.h"
      3          #define SETTING_VERSION	1
      4          
      5          struct LocalSettings {
      6          	unsigned  StructVersion;
      7          	unsigned  MyId;
      8          	unsigned  MyAddress;
      9          	int       xMin,xMax,yMin,yMax;
     10          	unsigned  OkId;
     11          
     12          };
     13          

   \                                 In segment CODE, align 4, keep-with-next
     14          void ReadLocalSettings(void)
     15          {
     16          #ifdef S2TXU
     17          	LocalSettings *Settings = (LocalSettings*)GetBlockAddress(SectorLocalSettings);
   \                     ??ReadLocalSettings:
   \   00000000   ........           LDR      R0,??DataTable7  ;; SectorLocalSettings
   \   00000004   10402DE9           PUSH     {R4,LR}
   \   00000008   000090E5           LDR      R0,[R0, #+0]
   \   0000000C   ........           _BLF     ??GetBlockAddress,??GetBlockAddress??rA
   \   00000010   0040B0E1           MOVS     R4,R0
     18          	if ( Settings
     19          			 && Settings->StructVersion == SETTING_VERSION
     20          			 && Settings->OkId  == 0x11223344 ) {
   \   00000014   1600000A           BEQ      ??ReadLocalSettings_1
   \   00000018   000094E5           LDR      R0,[R4, #+0]
   \   0000001C   010050E3           CMP      R0,#+1
   \   00000020   1300001A           BNE      ??ReadLocalSettings_1
   \   00000024   1C0094E5           LDR      R0,[R4, #+28]
   \   00000028   ........           LDR      R1,??DataTable6  ;; 0x11223344
   \   0000002C   010050E1           CMP      R0,R1
   \   00000030   0F00001A           BNE      ??ReadLocalSettings_1
     21          		PROTanksystemUnit::MySettingsId = Settings->MyId ;
   \   00000034   ........           LDR      R0,??DataTable5  ;; ??MySettingsId
   \   00000038   041094E5           LDR      R1,[R4, #+4]
   \   0000003C   001080E5           STR      R1,[R0, #+0]
     22          		switch ( GlobalDeviceHWId ) {
   \   00000040   ........           LDR      R0,??DataTable4  ;; GlobalDeviceHWId
   \   00000044   F000D0E1           LDRSH    R0,[R0, #+0]
   \   00000048   020040E2           SUB      R0,R0,#+2
   \   0000004C   010050E3           CMP      R0,#+1
   \   00000050   0700008A           BHI      ??ReadLocalSettings_1
     23          			case TCU_R1://TCU
     24          			case TCU_R2://TCU CurrentDeviceId should be 0x21
     25          				break;
     26          			case TDU_R1://TCU
     27          			case TDU_R2://TCU CurrentDeviceId should be 0x21
     28          				GUI_TOUCH_SetCalData(0,Settings->xMin,Settings->xMax);
   \   00000054   102094E5           LDR      R2,[R4, #+16]
   \   00000058   0C1094E5           LDR      R1,[R4, #+12]
   \   0000005C   0000A0E3           MOV      R0,#+0
   \   00000060   ........           _BLF     GUI_TOUCH_SetCalData,??GUI_TOUCH_SetCalData??rA
     29          				GUI_TOUCH_SetCalData(1,Settings->yMin,Settings->yMax);
   \   00000064   182094E5           LDR      R2,[R4, #+24]
   \   00000068   141094E5           LDR      R1,[R4, #+20]
   \   0000006C   0100A0E3           MOV      R0,#+1
   \   00000070   ........           _BLF     GUI_TOUCH_SetCalData,??GUI_TOUCH_SetCalData??rA
     30          				break;
     31          		}
     32          	}
     33          #else
     34          #endif
     35          
     36          }
   \                     ??ReadLocalSettings_1:
   \   00000074   1040BDE8           POP      {R4,LR}
   \   00000078   1EFF2FE1           BX       LR               ;; return
     37          

   \                                 In segment CODE, align 4, keep-with-next
     38          void WriteLocalSettings(void)
     39          {
   \                     ??WriteLocalSettings:
   \   00000000   10402DE9           PUSH     {R4,LR}
   \   00000004   20D04DE2           SUB      SP,SP,#+32
     40          #ifdef S2TXU
     41          	LocalSettings Settings;
     42          	Settings.StructVersion = SETTING_VERSION;
     43          	Settings.MyId       = PROTanksystemUnit::MySettingsId;
     44          	Settings.MyAddress  = CurrentDeviceAddress;
     45          	Settings.OkId       = 0x11223344;
     46          	switch ( GlobalDeviceHWId ) {
   \   00000008   ........           LDR      R0,??DataTable4  ;; GlobalDeviceHWId
   \   0000000C   0110A0E3           MOV      R1,#+1
   \   00000010   F000D0E1           LDRSH    R0,[R0, #+0]
   \   00000014   00108DE5           STR      R1,[SP, #+0]
   \   00000018   ........           LDR      R1,??DataTable5  ;; ??MySettingsId
   \   0000001C   010050E3           CMP      R0,#+1
   \   00000020   001091E5           LDR      R1,[R1, #+0]
   \   00000024   04108DE5           STR      R1,[SP, #+4]
   \   00000028   84109FE5           LDR      R1,??WriteLocalSettings_1  ;; CurrentDeviceAddress
   \   0000002C   F010D1E1           LDRSH    R1,[R1, #+0]
   \   00000030   08108DE5           STR      R1,[SP, #+8]
   \   00000034   ........           LDR      R1,??DataTable6  ;; 0x11223344
   \   00000038   1C108DE5           STR      R1,[SP, #+28]
   \   0000003C   0300009A           BLS      ??WriteLocalSettings_2
   \   00000040   020040E2           SUB      R0,R0,#+2
   \   00000044   010050E3           CMP      R0,#+1
   \   00000048   0600009A           BLS      ??WriteLocalSettings_3
   \   0000004C   0D0000EA           B        ??WriteLocalSettings_4
     47          		case TCU_R1://TCU
     48          		case TCU_R2://TCU CurrentDeviceId should be 0x21
     49          			Settings.xMin = 0;
   \                     ??WriteLocalSettings_2:
   \   00000050   0000A0E3           MOV      R0,#+0
   \   00000054   0C008DE5           STR      R0,[SP, #+12]
     50          			Settings.xMax = 0;
   \   00000058   10008DE5           STR      R0,[SP, #+16]
     51          			Settings.yMin = 0;
   \   0000005C   14008DE5           STR      R0,[SP, #+20]
     52          			Settings.yMax = 0;
   \   00000060   18008DE5           STR      R0,[SP, #+24]
   \   00000064   070000EA           B        ??WriteLocalSettings_4
     53          			break;
     54          		case TDU_R1://TCU
     55          		case TDU_R2://TCU CurrentDeviceId should be 0x21
     56          			GUI_TOUCH_GetCalData(0,&Settings.xMin,&Settings.xMax);
   \                     ??WriteLocalSettings_3:
   \   00000068   10208DE2           ADD      R2,SP,#+16
   \   0000006C   0C108DE2           ADD      R1,SP,#+12
   \   00000070   0000A0E3           MOV      R0,#+0
   \   00000074   ........           _BLF     GUI_TOUCH_GetCalData,??GUI_TOUCH_GetCalData??rA
     57          			GUI_TOUCH_GetCalData(1,&Settings.yMin,&Settings.yMax);
   \   00000078   18208DE2           ADD      R2,SP,#+24
   \   0000007C   14108DE2           ADD      R1,SP,#+20
   \   00000080   0100A0E3           MOV      R0,#+1
   \   00000084   ........           _BLF     GUI_TOUCH_GetCalData,??GUI_TOUCH_GetCalData??rA
     58          			break;
     59          	}
     60          
     61          	MX29LV_EraseSector(SectorLocalSettings);
   \                     ??WriteLocalSettings_4:
   \   00000088   ........           LDR      R4,??DataTable7  ;; SectorLocalSettings
   \   0000008C   000094E5           LDR      R0,[R4, #+0]
   \   00000090   ........           _BLF     ??MX29LV_EraseSector,??MX29LV_EraseSector??rA
     62          	ProgramMX29LV(SectorLocalSettings,0,(U32)&Settings,sizeof(Settings));
   \   00000094   000094E5           LDR      R0,[R4, #+0]
   \   00000098   2030A0E3           MOV      R3,#+32
   \   0000009C   0D20A0E1           MOV      R2,SP
   \   000000A0   0010A0E3           MOV      R1,#+0
   \   000000A4   ........           _BLF     ??ProgramMX29LV,??ProgramMX29LV??rA
     63          #else
     64          #endif
     65          }
   \   000000A8   20D08DE2           ADD      SP,SP,#+32
   \   000000AC   1040BDE8           POP      {R4,LR}
   \   000000B0   1EFF2FE1           BX       LR               ;; return
   \                     ??WriteLocalSettings_1:
   \   000000B4   ........           DC32     CurrentDeviceAddress

   \                                 In segment DIFUNCT, align 4, keep-with-next, root
   \   00000000                      REQUIRE ?call_ctors
   \   00000000   ........           DC32    ??__sti__routine

   \                                 In segment CODE, align 4, keep-with-next
   \   static __??Code32?? __intrinsic __code __interwork __atpcs void __sti__routine()
   \                     ??__sti__routine:
   \   00000000   1EFF2FE1           BX       LR               ;; return

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable4:
   \   00000000   ........           DC32     GlobalDeviceHWId

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable5:
   \   00000000   ........           DC32     ??MySettingsId

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable6:
   \   00000000   44332211           DC32     0x11223344

   \                                 In segment CODE, align 4, keep-with-next
   \                     ??DataTable7:
   \   00000000   ........           DC32     SectorLocalSettings
     66          
     67          
     68          
     69          
     70          
     71          
     72          
     73          
     74          
     75          
     76          

   Maximum stack usage in bytes:

     Function             CSTACK
     --------             ------
     ReadLocalSettings()      8
     WriteLocalSettings()    40
     __sti__routine()         0


   Segment part sizes:

     Function/Label       Bytes
     --------------       -----
     ReadLocalSettings()   124
     WriteLocalSettings()  184
     __sti__routine()        4
     ??DataTable4            4
     ??DataTable5            4
     ??DataTable6            4
     ??DataTable7            4
      Others                76

 
 400 bytes in segment CODE
   4 bytes in segment DIFUNCT
 
 332 bytes of CODE memory (+ 72 bytes shared)

Errors: none
Warnings: none
