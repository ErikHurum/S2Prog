###############################################################################
#
# IAR C/C++ Compiler V7.30.5.1680 for Microchip AVR       02/Oct/2023  15:18:53
# Copyright 1996-2022 IAR Systems AB.
# Mobile license - IAR Embedded Workbench for Microchip AVR 8.10
#
#    Source file  =  
#        C:\Users\ESY\OneDrive -
#        Scanjet\Documents\GitHub\S2Prog\IO\AN-ZBHART\Src\hart_gpio.c
#    Command line =  
#        -f C:\Users\ESY\AppData\Local\Temp\EWCFDE.tmp ("C:\Users\ESY\OneDrive
#        - Scanjet\Documents\GitHub\S2Prog\IO\AN-ZBHART\Src\hart_gpio.c"
#        --cpu=m1280 -ms -o "C:\Users\ESY\OneDrive -
#        Scanjet\Documents\GitHub\S2Prog\IO\AN-ZBHART\Debug\Obj" -D
#        OS_LIBMODE_D -D OS_UART=-1 -lCN "C:\Users\ESY\OneDrive -
#        Scanjet\Documents\GitHub\S2Prog\IO\AN-ZBHART\Debug\List" -y
#        --initializers_in_flash --no_cse --no_inline --no_code_motion
#        --no_cross_call --no_clustering --no_tbaa --debug
#        -DENABLE_BIT_DEFINITIONS -e -I "C:\Users\ESY\OneDrive -
#        Scanjet\Documents\GitHub\S2Prog\IO\AN-ZBHART\INC\\" -I
#        ..\..\..\Shared\Inc\\ --eeprom_size 4096 --clib -On)
#    Locale       =  English_USA.1252
#    List file    =  
#        C:\Users\ESY\OneDrive -
#        Scanjet\Documents\GitHub\S2Prog\IO\AN-ZBHART\Debug\List\hart_gpio.lst
#    Object file  =  
#        C:\Users\ESY\OneDrive -
#        Scanjet\Documents\GitHub\S2Prog\IO\AN-ZBHART\Debug\Obj\hart_gpio.r90
#
###############################################################################

C:\Users\ESY\OneDrive - Scanjet\Documents\GitHub\S2Prog\IO\AN-ZBHART\Src\hart_gpio.c
      1          #include <stdio.h>
      2          #include "iom1280.h"

   \                                 In  segment ABSOLUTE, at 0x10b
   \   union <unnamed> volatile __ext_io _A_PORTL
   \                     _A_PORTL:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x10a
   \   union <unnamed> volatile __ext_io _A_DDRL
   \                     _A_DDRL:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x108
   \   union <unnamed> volatile __ext_io _A_PORTK
   \                     _A_PORTK:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x107
   \   union <unnamed> volatile __ext_io _A_DDRK
   \                     _A_DDRK:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x105
   \   union <unnamed> volatile __ext_io _A_PORTJ
   \                     _A_PORTJ:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x104
   \   union <unnamed> volatile __ext_io _A_DDRJ
   \                     _A_DDRJ:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x102
   \   union <unnamed> volatile __ext_io _A_PORTH
   \                     _A_PORTH:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x101
   \   union <unnamed> volatile __ext_io _A_DDRH
   \                     _A_DDRH:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x34
   \   union <unnamed> volatile __io _A_PORTG
   \                     _A_PORTG:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x33
   \   union <unnamed> volatile __io _A_DDRG
   \                     _A_DDRG:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x31
   \   union <unnamed> volatile __io _A_PORTF
   \                     _A_PORTF:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x30
   \   union <unnamed> volatile __io _A_DDRF
   \                     _A_DDRF:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x2e
   \   union <unnamed> volatile __io _A_PORTE
   \                     _A_PORTE:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x2d
   \   union <unnamed> volatile __io _A_DDRE
   \                     _A_DDRE:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x2b
   \   union <unnamed> volatile __io _A_PORTD
   \                     _A_PORTD:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x2a
   \   union <unnamed> volatile __io _A_DDRD
   \                     _A_DDRD:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x28
   \   union <unnamed> volatile __io _A_PORTC
   \                     _A_PORTC:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x27
   \   union <unnamed> volatile __io _A_DDRC
   \                     _A_DDRC:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x22
   \   union <unnamed> volatile __io _A_PORTA
   \                     _A_PORTA:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x21
   \   union <unnamed> volatile __io _A_DDRA
   \                     _A_DDRA:
   \   00000000                      DS8 1
      3          #include "RTOS.h"
      4          #include "constants.h"
      5          
      6          #include "hart_gpio.h"
      7          
      8          ////////////////////////////////////////////////////////////////////////////////
      9          //
     10          // Channel Power Control
     11          //
     12          ////////////////////////////////////////////////////////////////////////////////
     13          /*
     14           * power control for each channel
     15           *
     16           * CHP0     : PA0
     17           * CHP1     : PA1
     18           * CHP2     : PA2
     19           * CHP3     : PA3
     20           * CHP4     : PA4
     21           * CHP5     : PA5
     22           * CHP6     : PA6
     23           * CHP7     : PA7
     24           * CHP8     : PJ4
     25           * CHP9     : PJ5
     26           * CHP10    : PJ6
     27           * CHP11    : PJ7
     28           *
     29           * HIGH     : Power On
     30           * LOW      : Power Off
     31           *
     32           */

   \                                 In  segment CODE, align 2, keep-with-next
     33          static void
     34          hart_gpio_power_gpio_init(void) {
   \                     hart_gpio_power_gpio_init:
     35              My_SetBit(DDRA, 0xff);         // PA0-PA7 as output
   \   00000000   9100....           LDS     R16, (OS_Global + 1)
   \   00000004   7F00               ANDI    R16, 0xF0
   \   00000006   2300               TST     R16
   \   00000008   F021               BREQ    ??hart_gpio_power_gpio_init_0
   \   0000000A   E909               LDI     R16, 153
   \   0000000C   E010               LDI     R17, 0
   \   0000000E   ........           CALL    OS_Error
   \                     ??hart_gpio_power_gpio_init_0:
   \   00000012   94F8               cli
   \   00000014   9100....           LDS     R16, (OS_Global + 1)
   \   00000018   9503               INC     R16
   \   0000001A   9300....           STS     (OS_Global + 1), R16
   \   0000001E   B111               IN      R17, 0x01
   \   00000020   EF0F               LDI     R16, 255
   \   00000022   B901               OUT     0x01, R16
   \   00000024   9100....           LDS     R16, (OS_Global + 1)
   \   00000028   7F00               ANDI    R16, 0xF0
   \   0000002A   2300               TST     R16
   \   0000002C   F021               BREQ    ??hart_gpio_power_gpio_init_1
   \   0000002E   E909               LDI     R16, 153
   \   00000030   E010               LDI     R17, 0
   \   00000032   ........           CALL    OS_Error
   \                     ??hart_gpio_power_gpio_init_1:
   \   00000036   9100....           LDS     R16, (OS_Global + 1)
   \   0000003A   950A               DEC     R16
   \   0000003C   9300....           STS     (OS_Global + 1), R16
   \   00000040   9100....           LDS     R16, (OS_Global + 1)
   \   00000044   2300               TST     R16
   \   00000046   F409               BRNE    ??hart_gpio_power_gpio_init_2
   \   00000048   9478               sei
     36              My_SetBit(DDRJ, 0xf0);         // PJ4-PJ7 as output
   \                     ??hart_gpio_power_gpio_init_2:
   \   0000004A   9100....           LDS     R16, (OS_Global + 1)
   \   0000004E   7F00               ANDI    R16, 0xF0
   \   00000050   2300               TST     R16
   \   00000052   F021               BREQ    ??hart_gpio_power_gpio_init_3
   \   00000054   E909               LDI     R16, 153
   \   00000056   E010               LDI     R17, 0
   \   00000058   ........           CALL    OS_Error
   \                     ??hart_gpio_power_gpio_init_3:
   \   0000005C   94F8               cli
   \   0000005E   9100....           LDS     R16, (OS_Global + 1)
   \   00000062   9503               INC     R16
   \   00000064   9300....           STS     (OS_Global + 1), R16
   \   00000068   9100....           LDS     R16, _A_DDRJ
   \   0000006C   6F00               ORI     R16, 0xF0
   \   0000006E   9300....           STS     _A_DDRJ, R16
   \   00000072   9100....           LDS     R16, (OS_Global + 1)
   \   00000076   7F00               ANDI    R16, 0xF0
   \   00000078   2300               TST     R16
   \   0000007A   F021               BREQ    ??hart_gpio_power_gpio_init_4
   \   0000007C   E909               LDI     R16, 153
   \   0000007E   E010               LDI     R17, 0
   \   00000080   ........           CALL    OS_Error
   \                     ??hart_gpio_power_gpio_init_4:
   \   00000084   9100....           LDS     R16, (OS_Global + 1)
   \   00000088   950A               DEC     R16
   \   0000008A   9300....           STS     (OS_Global + 1), R16
   \   0000008E   9100....           LDS     R16, (OS_Global + 1)
   \   00000092   2300               TST     R16
   \   00000094   F409               BRNE    ??hart_gpio_power_gpio_init_5
   \   00000096   9478               sei
     37          
     38              //
     39              // power off everything just to make sure
     40              //
     41              My_ClrBit(PORTA, 0xff);        // PA0-PA7 LOW
   \                     ??hart_gpio_power_gpio_init_5:
   \   00000098   9100....           LDS     R16, (OS_Global + 1)
   \   0000009C   7F00               ANDI    R16, 0xF0
   \   0000009E   2300               TST     R16
   \   000000A0   F021               BREQ    ??hart_gpio_power_gpio_init_6
   \   000000A2   E909               LDI     R16, 153
   \   000000A4   E010               LDI     R17, 0
   \   000000A6   ........           CALL    OS_Error
   \                     ??hart_gpio_power_gpio_init_6:
   \   000000AA   94F8               cli
   \   000000AC   9100....           LDS     R16, (OS_Global + 1)
   \   000000B0   9503               INC     R16
   \   000000B2   9300....           STS     (OS_Global + 1), R16
   \   000000B6   B112               IN      R17, 0x02
   \   000000B8   E000               LDI     R16, 0
   \   000000BA   B902               OUT     0x02, R16
   \   000000BC   9100....           LDS     R16, (OS_Global + 1)
   \   000000C0   7F00               ANDI    R16, 0xF0
   \   000000C2   2300               TST     R16
   \   000000C4   F021               BREQ    ??hart_gpio_power_gpio_init_7
   \   000000C6   E909               LDI     R16, 153
   \   000000C8   E010               LDI     R17, 0
   \   000000CA   ........           CALL    OS_Error
   \                     ??hart_gpio_power_gpio_init_7:
   \   000000CE   9100....           LDS     R16, (OS_Global + 1)
   \   000000D2   950A               DEC     R16
   \   000000D4   9300....           STS     (OS_Global + 1), R16
   \   000000D8   9100....           LDS     R16, (OS_Global + 1)
   \   000000DC   2300               TST     R16
   \   000000DE   F409               BRNE    ??hart_gpio_power_gpio_init_8
   \   000000E0   9478               sei
     42              My_ClrBit(PORTJ, 0xf0);        // PJ4-PJ7 LOW
   \                     ??hart_gpio_power_gpio_init_8:
   \   000000E2   9100....           LDS     R16, (OS_Global + 1)
   \   000000E6   7F00               ANDI    R16, 0xF0
   \   000000E8   2300               TST     R16
   \   000000EA   F021               BREQ    ??hart_gpio_power_gpio_init_9
   \   000000EC   E909               LDI     R16, 153
   \   000000EE   E010               LDI     R17, 0
   \   000000F0   ........           CALL    OS_Error
   \                     ??hart_gpio_power_gpio_init_9:
   \   000000F4   94F8               cli
   \   000000F6   9100....           LDS     R16, (OS_Global + 1)
   \   000000FA   9503               INC     R16
   \   000000FC   9300....           STS     (OS_Global + 1), R16
   \   00000100   9100....           LDS     R16, _A_PORTJ
   \   00000104   700F               ANDI    R16, 0x0F
   \   00000106   9300....           STS     _A_PORTJ, R16
   \   0000010A   9100....           LDS     R16, (OS_Global + 1)
   \   0000010E   7F00               ANDI    R16, 0xF0
   \   00000110   2300               TST     R16
   \   00000112   F021               BREQ    ??hart_gpio_power_gpio_init_10
   \   00000114   E909               LDI     R16, 153
   \   00000116   E010               LDI     R17, 0
   \   00000118   ........           CALL    OS_Error
   \                     ??hart_gpio_power_gpio_init_10:
   \   0000011C   9100....           LDS     R16, (OS_Global + 1)
   \   00000120   950A               DEC     R16
   \   00000122   9300....           STS     (OS_Global + 1), R16
   \   00000126   9100....           LDS     R16, (OS_Global + 1)
   \   0000012A   2300               TST     R16
   \   0000012C   F409               BRNE    ??hart_gpio_power_gpio_init_11
   \   0000012E   9478               sei
     43          }
   \                     ??hart_gpio_power_gpio_init_11:
   \   00000130   9508               RET
   \   00000132                      REQUIRE _A_DDRA
   \   00000132                      REQUIRE _A_DDRJ
   \   00000132                      REQUIRE _A_PORTA
   \   00000132                      REQUIRE _A_PORTJ
     44          

   \                                 In  segment CODE, align 2, keep-with-next
     45          void
     46          hart_gpio_power_on(hart_channel_t chnl) {
   \                     hart_gpio_power_on:
   \   00000000   938A               ST      -Y, R24
   \   00000002   2F80               MOV     R24, R16
     47              switch ( chnl ) {
   \   00000004   2F08               MOV     R16, R24
   \   00000006   5000               SUBI    R16, 0
   \   00000008   5008               SUBI    R16, 8
   \   0000000A   F028               BRCS    ??hart_gpio_power_on_0
   \   0000000C   5000               SUBI    R16, 0
   \   0000000E   F010               BRCS    ??hart_gpio_power_on_1
   \   00000010   5004               SUBI    R16, 4
   \   00000012   F160               BRCS    ??hart_gpio_power_on_2
   \                     ??hart_gpio_power_on_1:
   \   00000014   C058               RJMP    ??hart_gpio_power_on_3
     48              case hart_channel_0:
     49              case hart_channel_1:
     50              case hart_channel_2:
     51              case hart_channel_3:
     52              case hart_channel_4:
     53              case hart_channel_5:
     54              case hart_channel_6:
     55              case hart_channel_7:
     56                  My_SetBit(PORTA, __BIT_MASK(chnl));
   \                     ??hart_gpio_power_on_0:
   \   00000016   9100....           LDS     R16, (OS_Global + 1)
   \   0000001A   7F00               ANDI    R16, 0xF0
   \   0000001C   2300               TST     R16
   \   0000001E   F021               BREQ    ??hart_gpio_power_on_4
   \   00000020   E909               LDI     R16, 153
   \   00000022   E010               LDI     R17, 0
   \   00000024   ........           CALL    OS_Error
   \                     ??hart_gpio_power_on_4:
   \   00000028   94F8               cli
   \   0000002A   9100....           LDS     R16, (OS_Global + 1)
   \   0000002E   9503               INC     R16
   \   00000030   9300....           STS     (OS_Global + 1), R16
   \   00000034   E001               LDI     R16, 1
   \   00000036   E010               LDI     R17, 0
   \   00000038   2F48               MOV     R20, R24
   \   0000003A   ........           CALL    ?S_SHL_L02
   \   0000003E   B112               IN      R17, 0x02
   \   00000040   2B10               OR      R17, R16
   \   00000042   B912               OUT     0x02, R17
   \   00000044   9100....           LDS     R16, (OS_Global + 1)
   \   00000048   7F00               ANDI    R16, 0xF0
   \   0000004A   2300               TST     R16
   \   0000004C   F021               BREQ    ??hart_gpio_power_on_5
   \   0000004E   E909               LDI     R16, 153
   \   00000050   E010               LDI     R17, 0
   \   00000052   ........           CALL    OS_Error
   \                     ??hart_gpio_power_on_5:
   \   00000056   9100....           LDS     R16, (OS_Global + 1)
   \   0000005A   950A               DEC     R16
   \   0000005C   9300....           STS     (OS_Global + 1), R16
   \   00000060   9100....           LDS     R16, (OS_Global + 1)
   \   00000064   2300               TST     R16
   \   00000066   F579               BRNE    ??hart_gpio_power_on_3
   \   00000068   9478               sei
     57                  break;
   \   0000006A   C02D               RJMP    ??hart_gpio_power_on_3
     58          
     59              case hart_channel_8:
     60              case hart_channel_9:
     61              case hart_channel_10:
     62              case hart_channel_11:
     63                  My_SetBit(PORTJ, __BIT_MASK(chnl - hart_channel_8 + 4));
   \                     ??hart_gpio_power_on_2:
   \   0000006C   9100....           LDS     R16, (OS_Global + 1)
   \   00000070   7F00               ANDI    R16, 0xF0
   \   00000072   2300               TST     R16
   \   00000074   F021               BREQ    ??hart_gpio_power_on_6
   \   00000076   E909               LDI     R16, 153
   \   00000078   E010               LDI     R17, 0
   \   0000007A   ........           CALL    OS_Error
   \                     ??hart_gpio_power_on_6:
   \   0000007E   94F8               cli
   \   00000080   9100....           LDS     R16, (OS_Global + 1)
   \   00000084   9503               INC     R16
   \   00000086   9300....           STS     (OS_Global + 1), R16
   \   0000008A   2F48               MOV     R20, R24
   \   0000008C   5044               SUBI    R20, 4
   \   0000008E   E001               LDI     R16, 1
   \   00000090   E010               LDI     R17, 0
   \   00000092   ........           CALL    ?S_SHL_L02
   \   00000096   9110....           LDS     R17, _A_PORTJ
   \   0000009A   2B10               OR      R17, R16
   \   0000009C   9310....           STS     _A_PORTJ, R17
   \   000000A0   9100....           LDS     R16, (OS_Global + 1)
   \   000000A4   7F00               ANDI    R16, 0xF0
   \   000000A6   2300               TST     R16
   \   000000A8   F021               BREQ    ??hart_gpio_power_on_7
   \   000000AA   E909               LDI     R16, 153
   \   000000AC   E010               LDI     R17, 0
   \   000000AE   ........           CALL    OS_Error
   \                     ??hart_gpio_power_on_7:
   \   000000B2   9100....           LDS     R16, (OS_Global + 1)
   \   000000B6   950A               DEC     R16
   \   000000B8   9300....           STS     (OS_Global + 1), R16
   \   000000BC   9100....           LDS     R16, (OS_Global + 1)
   \   000000C0   2300               TST     R16
   \   000000C2   F409               BRNE    ??hart_gpio_power_on_3
   \   000000C4   9478               sei
     64                  break;
     65              }
     66          }
   \                     ??hart_gpio_power_on_3:
   \   000000C6   9189               LD      R24, Y+
   \   000000C8   9508               RET
   \   000000CA                      REQUIRE _A_PORTA
   \   000000CA                      REQUIRE _A_PORTJ
     67          

   \                                 In  segment CODE, align 2, keep-with-next
     68          void
     69          hart_gpio_power_off(hart_channel_t chnl) {
   \                     hart_gpio_power_off:
   \   00000000   938A               ST      -Y, R24
   \   00000002   2F80               MOV     R24, R16
     70              switch ( chnl ) {
   \   00000004   2F08               MOV     R16, R24
   \   00000006   5000               SUBI    R16, 0
   \   00000008   5008               SUBI    R16, 8
   \   0000000A   F028               BRCS    ??hart_gpio_power_off_0
   \   0000000C   5000               SUBI    R16, 0
   \   0000000E   F010               BRCS    ??hart_gpio_power_off_1
   \   00000010   5004               SUBI    R16, 4
   \   00000012   F168               BRCS    ??hart_gpio_power_off_2
   \                     ??hart_gpio_power_off_1:
   \   00000014   C05A               RJMP    ??hart_gpio_power_off_3
     71              case hart_channel_0:
     72              case hart_channel_1:
     73              case hart_channel_2:
     74              case hart_channel_3:
     75              case hart_channel_4:
     76              case hart_channel_5:
     77              case hart_channel_6:
     78              case hart_channel_7:
     79                  My_ClrBit(PORTA, __BIT_MASK(chnl));
   \                     ??hart_gpio_power_off_0:
   \   00000016   9100....           LDS     R16, (OS_Global + 1)
   \   0000001A   7F00               ANDI    R16, 0xF0
   \   0000001C   2300               TST     R16
   \   0000001E   F021               BREQ    ??hart_gpio_power_off_4
   \   00000020   E909               LDI     R16, 153
   \   00000022   E010               LDI     R17, 0
   \   00000024   ........           CALL    OS_Error
   \                     ??hart_gpio_power_off_4:
   \   00000028   94F8               cli
   \   0000002A   9100....           LDS     R16, (OS_Global + 1)
   \   0000002E   9503               INC     R16
   \   00000030   9300....           STS     (OS_Global + 1), R16
   \   00000034   E001               LDI     R16, 1
   \   00000036   E010               LDI     R17, 0
   \   00000038   2F48               MOV     R20, R24
   \   0000003A   ........           CALL    ?S_SHL_L02
   \   0000003E   9500               COM     R16
   \   00000040   B112               IN      R17, 0x02
   \   00000042   2310               AND     R17, R16
   \   00000044   B912               OUT     0x02, R17
   \   00000046   9100....           LDS     R16, (OS_Global + 1)
   \   0000004A   7F00               ANDI    R16, 0xF0
   \   0000004C   2300               TST     R16
   \   0000004E   F021               BREQ    ??hart_gpio_power_off_5
   \   00000050   E909               LDI     R16, 153
   \   00000052   E010               LDI     R17, 0
   \   00000054   ........           CALL    OS_Error
   \                     ??hart_gpio_power_off_5:
   \   00000058   9100....           LDS     R16, (OS_Global + 1)
   \   0000005C   950A               DEC     R16
   \   0000005E   9300....           STS     (OS_Global + 1), R16
   \   00000062   9100....           LDS     R16, (OS_Global + 1)
   \   00000066   2300               TST     R16
   \   00000068   F581               BRNE    ??hart_gpio_power_off_3
   \   0000006A   9478               sei
     80                  break;
   \   0000006C   C02E               RJMP    ??hart_gpio_power_off_3
     81          
     82              case hart_channel_8:
     83              case hart_channel_9:
     84              case hart_channel_10:
     85              case hart_channel_11:
     86                  My_ClrBit(PORTJ, __BIT_MASK((chnl - hart_channel_8 + 4)));
   \                     ??hart_gpio_power_off_2:
   \   0000006E   9100....           LDS     R16, (OS_Global + 1)
   \   00000072   7F00               ANDI    R16, 0xF0
   \   00000074   2300               TST     R16
   \   00000076   F021               BREQ    ??hart_gpio_power_off_6
   \   00000078   E909               LDI     R16, 153
   \   0000007A   E010               LDI     R17, 0
   \   0000007C   ........           CALL    OS_Error
   \                     ??hart_gpio_power_off_6:
   \   00000080   94F8               cli
   \   00000082   9100....           LDS     R16, (OS_Global + 1)
   \   00000086   9503               INC     R16
   \   00000088   9300....           STS     (OS_Global + 1), R16
   \   0000008C   2F48               MOV     R20, R24
   \   0000008E   5044               SUBI    R20, 4
   \   00000090   E001               LDI     R16, 1
   \   00000092   E010               LDI     R17, 0
   \   00000094   ........           CALL    ?S_SHL_L02
   \   00000098   9500               COM     R16
   \   0000009A   9110....           LDS     R17, _A_PORTJ
   \   0000009E   2310               AND     R17, R16
   \   000000A0   9310....           STS     _A_PORTJ, R17
   \   000000A4   9100....           LDS     R16, (OS_Global + 1)
   \   000000A8   7F00               ANDI    R16, 0xF0
   \   000000AA   2300               TST     R16
   \   000000AC   F021               BREQ    ??hart_gpio_power_off_7
   \   000000AE   E909               LDI     R16, 153
   \   000000B0   E010               LDI     R17, 0
   \   000000B2   ........           CALL    OS_Error
   \                     ??hart_gpio_power_off_7:
   \   000000B6   9100....           LDS     R16, (OS_Global + 1)
   \   000000BA   950A               DEC     R16
   \   000000BC   9300....           STS     (OS_Global + 1), R16
   \   000000C0   9100....           LDS     R16, (OS_Global + 1)
   \   000000C4   2300               TST     R16
   \   000000C6   F409               BRNE    ??hart_gpio_power_off_3
   \   000000C8   9478               sei
     87                  break;
     88              }
     89          }
   \                     ??hart_gpio_power_off_3:
   \   000000CA   9189               LD      R24, Y+
   \   000000CC   9508               RET
   \   000000CE                      REQUIRE _A_PORTA
   \   000000CE                      REQUIRE _A_PORTJ
     90          
     91          
     92          ////////////////////////////////////////////////////////////////////////////////
     93          //
     94          // Modem MUX control
     95          //
     96          ////////////////////////////////////////////////////////////////////////////////
     97          /*
     98           *    MUX0
     99           * ENABLE     : PD5
    100           * ADR0       : PK0
    101           * ADR1       : PK1
    102           *
    103           *    MUX1
    104           * ENABLE     : PH3
    105           * ADR0       : PK4
    106           * ADR1       : PK5
    107           *
    108           *    MUX2
    109           * ENABLE     : PJ3
    110           * ADR0       : PC0
    111           * ADR1       : PC1
    112           *
    113           */

   \                                 In  segment CODE, align 2, keep-with-next
    114          static void
    115          hart_gpio_mux_gpio_init(void) {
   \                     hart_gpio_mux_gpio_init:
    116              //
    117              // MUX0
    118              //
    119              My_SetBit(DDRD, __BIT_MASK(5));    // ENABLE : PD5 as output
   \   00000000   9100....           LDS     R16, (OS_Global + 1)
   \   00000004   7F00               ANDI    R16, 0xF0
   \   00000006   2300               TST     R16
   \   00000008   F021               BREQ    ??hart_gpio_mux_gpio_init_0
   \   0000000A   E909               LDI     R16, 153
   \   0000000C   E010               LDI     R17, 0
   \   0000000E   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_0:
   \   00000012   94F8               cli
   \   00000014   9100....           LDS     R16, (OS_Global + 1)
   \   00000018   9503               INC     R16
   \   0000001A   9300....           STS     (OS_Global + 1), R16
   \   0000001E   9A55               SBI     0x0A, 0x05
   \   00000020   9100....           LDS     R16, (OS_Global + 1)
   \   00000024   7F00               ANDI    R16, 0xF0
   \   00000026   2300               TST     R16
   \   00000028   F021               BREQ    ??hart_gpio_mux_gpio_init_1
   \   0000002A   E909               LDI     R16, 153
   \   0000002C   E010               LDI     R17, 0
   \   0000002E   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_1:
   \   00000032   9100....           LDS     R16, (OS_Global + 1)
   \   00000036   950A               DEC     R16
   \   00000038   9300....           STS     (OS_Global + 1), R16
   \   0000003C   9100....           LDS     R16, (OS_Global + 1)
   \   00000040   2300               TST     R16
   \   00000042   F409               BRNE    ??hart_gpio_mux_gpio_init_2
   \   00000044   9478               sei
    120              My_SetBit(DDRK, __BIT_MASK(0));    // ADDR0  : PK0 as output
   \                     ??hart_gpio_mux_gpio_init_2:
   \   00000046   9100....           LDS     R16, (OS_Global + 1)
   \   0000004A   7F00               ANDI    R16, 0xF0
   \   0000004C   2300               TST     R16
   \   0000004E   F021               BREQ    ??hart_gpio_mux_gpio_init_3
   \   00000050   E909               LDI     R16, 153
   \   00000052   E010               LDI     R17, 0
   \   00000054   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_3:
   \   00000058   94F8               cli
   \   0000005A   9100....           LDS     R16, (OS_Global + 1)
   \   0000005E   9503               INC     R16
   \   00000060   9300....           STS     (OS_Global + 1), R16
   \   00000064   91000107           LDS     R16, 263
   \   00000068   6001               ORI     R16, 0x01
   \   0000006A   93000107           STS     263, R16
   \   0000006E   9100....           LDS     R16, (OS_Global + 1)
   \   00000072   7F00               ANDI    R16, 0xF0
   \   00000074   2300               TST     R16
   \   00000076   F021               BREQ    ??hart_gpio_mux_gpio_init_4
   \   00000078   E909               LDI     R16, 153
   \   0000007A   E010               LDI     R17, 0
   \   0000007C   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_4:
   \   00000080   9100....           LDS     R16, (OS_Global + 1)
   \   00000084   950A               DEC     R16
   \   00000086   9300....           STS     (OS_Global + 1), R16
   \   0000008A   9100....           LDS     R16, (OS_Global + 1)
   \   0000008E   2300               TST     R16
   \   00000090   F409               BRNE    ??hart_gpio_mux_gpio_init_5
   \   00000092   9478               sei
    121              My_SetBit(DDRK, __BIT_MASK(1));    // ADDR1  : PK1 as output
   \                     ??hart_gpio_mux_gpio_init_5:
   \   00000094   9100....           LDS     R16, (OS_Global + 1)
   \   00000098   7F00               ANDI    R16, 0xF0
   \   0000009A   2300               TST     R16
   \   0000009C   F021               BREQ    ??hart_gpio_mux_gpio_init_6
   \   0000009E   E909               LDI     R16, 153
   \   000000A0   E010               LDI     R17, 0
   \   000000A2   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_6:
   \   000000A6   94F8               cli
   \   000000A8   9100....           LDS     R16, (OS_Global + 1)
   \   000000AC   9503               INC     R16
   \   000000AE   9300....           STS     (OS_Global + 1), R16
   \   000000B2   91000107           LDS     R16, 263
   \   000000B6   6002               ORI     R16, 0x02
   \   000000B8   93000107           STS     263, R16
   \   000000BC   9100....           LDS     R16, (OS_Global + 1)
   \   000000C0   7F00               ANDI    R16, 0xF0
   \   000000C2   2300               TST     R16
   \   000000C4   F021               BREQ    ??hart_gpio_mux_gpio_init_7
   \   000000C6   E909               LDI     R16, 153
   \   000000C8   E010               LDI     R17, 0
   \   000000CA   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_7:
   \   000000CE   9100....           LDS     R16, (OS_Global + 1)
   \   000000D2   950A               DEC     R16
   \   000000D4   9300....           STS     (OS_Global + 1), R16
   \   000000D8   9100....           LDS     R16, (OS_Global + 1)
   \   000000DC   2300               TST     R16
   \   000000DE   F409               BRNE    ??hart_gpio_mux_gpio_init_8
   \   000000E0   9478               sei
    122          
    123              //
    124              // MUX1
    125              //
    126              My_SetBit(DDRH, __BIT_MASK(3));    // ENABLE : PH3 as output
   \                     ??hart_gpio_mux_gpio_init_8:
   \   000000E2   9100....           LDS     R16, (OS_Global + 1)
   \   000000E6   7F00               ANDI    R16, 0xF0
   \   000000E8   2300               TST     R16
   \   000000EA   F021               BREQ    ??hart_gpio_mux_gpio_init_9
   \   000000EC   E909               LDI     R16, 153
   \   000000EE   E010               LDI     R17, 0
   \   000000F0   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_9:
   \   000000F4   94F8               cli
   \   000000F6   9100....           LDS     R16, (OS_Global + 1)
   \   000000FA   9503               INC     R16
   \   000000FC   9300....           STS     (OS_Global + 1), R16
   \   00000100   91000101           LDS     R16, 257
   \   00000104   6008               ORI     R16, 0x08
   \   00000106   93000101           STS     257, R16
   \   0000010A   9100....           LDS     R16, (OS_Global + 1)
   \   0000010E   7F00               ANDI    R16, 0xF0
   \   00000110   2300               TST     R16
   \   00000112   F021               BREQ    ??hart_gpio_mux_gpio_init_10
   \   00000114   E909               LDI     R16, 153
   \   00000116   E010               LDI     R17, 0
   \   00000118   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_10:
   \   0000011C   9100....           LDS     R16, (OS_Global + 1)
   \   00000120   950A               DEC     R16
   \   00000122   9300....           STS     (OS_Global + 1), R16
   \   00000126   9100....           LDS     R16, (OS_Global + 1)
   \   0000012A   2300               TST     R16
   \   0000012C   F409               BRNE    ??hart_gpio_mux_gpio_init_11
   \   0000012E   9478               sei
    127              My_SetBit(DDRK, __BIT_MASK(4));    // ADDR0  : PK4 as output
   \                     ??hart_gpio_mux_gpio_init_11:
   \   00000130   9100....           LDS     R16, (OS_Global + 1)
   \   00000134   7F00               ANDI    R16, 0xF0
   \   00000136   2300               TST     R16
   \   00000138   F021               BREQ    ??hart_gpio_mux_gpio_init_12
   \   0000013A   E909               LDI     R16, 153
   \   0000013C   E010               LDI     R17, 0
   \   0000013E   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_12:
   \   00000142   94F8               cli
   \   00000144   9100....           LDS     R16, (OS_Global + 1)
   \   00000148   9503               INC     R16
   \   0000014A   9300....           STS     (OS_Global + 1), R16
   \   0000014E   91000107           LDS     R16, 263
   \   00000152   6100               ORI     R16, 0x10
   \   00000154   93000107           STS     263, R16
   \   00000158   9100....           LDS     R16, (OS_Global + 1)
   \   0000015C   7F00               ANDI    R16, 0xF0
   \   0000015E   2300               TST     R16
   \   00000160   F021               BREQ    ??hart_gpio_mux_gpio_init_13
   \   00000162   E909               LDI     R16, 153
   \   00000164   E010               LDI     R17, 0
   \   00000166   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_13:
   \   0000016A   9100....           LDS     R16, (OS_Global + 1)
   \   0000016E   950A               DEC     R16
   \   00000170   9300....           STS     (OS_Global + 1), R16
   \   00000174   9100....           LDS     R16, (OS_Global + 1)
   \   00000178   2300               TST     R16
   \   0000017A   F409               BRNE    ??hart_gpio_mux_gpio_init_14
   \   0000017C   9478               sei
    128              My_SetBit(DDRK, __BIT_MASK(5));    // ADDR1  : PK5 as output
   \                     ??hart_gpio_mux_gpio_init_14:
   \   0000017E   9100....           LDS     R16, (OS_Global + 1)
   \   00000182   7F00               ANDI    R16, 0xF0
   \   00000184   2300               TST     R16
   \   00000186   F021               BREQ    ??hart_gpio_mux_gpio_init_15
   \   00000188   E909               LDI     R16, 153
   \   0000018A   E010               LDI     R17, 0
   \   0000018C   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_15:
   \   00000190   94F8               cli
   \   00000192   9100....           LDS     R16, (OS_Global + 1)
   \   00000196   9503               INC     R16
   \   00000198   9300....           STS     (OS_Global + 1), R16
   \   0000019C   91000107           LDS     R16, 263
   \   000001A0   6200               ORI     R16, 0x20
   \   000001A2   93000107           STS     263, R16
   \   000001A6   9100....           LDS     R16, (OS_Global + 1)
   \   000001AA   7F00               ANDI    R16, 0xF0
   \   000001AC   2300               TST     R16
   \   000001AE   F021               BREQ    ??hart_gpio_mux_gpio_init_16
   \   000001B0   E909               LDI     R16, 153
   \   000001B2   E010               LDI     R17, 0
   \   000001B4   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_16:
   \   000001B8   9100....           LDS     R16, (OS_Global + 1)
   \   000001BC   950A               DEC     R16
   \   000001BE   9300....           STS     (OS_Global + 1), R16
   \   000001C2   9100....           LDS     R16, (OS_Global + 1)
   \   000001C6   2300               TST     R16
   \   000001C8   F409               BRNE    ??hart_gpio_mux_gpio_init_17
   \   000001CA   9478               sei
    129          
    130              //
    131              // MUX2
    132              //
    133              My_SetBit(DDRJ, __BIT_MASK(3));    // ENABLE : PJ3 as output
   \                     ??hart_gpio_mux_gpio_init_17:
   \   000001CC   9100....           LDS     R16, (OS_Global + 1)
   \   000001D0   7F00               ANDI    R16, 0xF0
   \   000001D2   2300               TST     R16
   \   000001D4   F021               BREQ    ??hart_gpio_mux_gpio_init_18
   \   000001D6   E909               LDI     R16, 153
   \   000001D8   E010               LDI     R17, 0
   \   000001DA   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_18:
   \   000001DE   94F8               cli
   \   000001E0   9100....           LDS     R16, (OS_Global + 1)
   \   000001E4   9503               INC     R16
   \   000001E6   9300....           STS     (OS_Global + 1), R16
   \   000001EA   91000104           LDS     R16, 260
   \   000001EE   6008               ORI     R16, 0x08
   \   000001F0   93000104           STS     260, R16
   \   000001F4   9100....           LDS     R16, (OS_Global + 1)
   \   000001F8   7F00               ANDI    R16, 0xF0
   \   000001FA   2300               TST     R16
   \   000001FC   F021               BREQ    ??hart_gpio_mux_gpio_init_19
   \   000001FE   E909               LDI     R16, 153
   \   00000200   E010               LDI     R17, 0
   \   00000202   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_19:
   \   00000206   9100....           LDS     R16, (OS_Global + 1)
   \   0000020A   950A               DEC     R16
   \   0000020C   9300....           STS     (OS_Global + 1), R16
   \   00000210   9100....           LDS     R16, (OS_Global + 1)
   \   00000214   2300               TST     R16
   \   00000216   F409               BRNE    ??hart_gpio_mux_gpio_init_20
   \   00000218   9478               sei
    134              My_SetBit(DDRC, __BIT_MASK(0));    // ADDR0  : PC0 as output
   \                     ??hart_gpio_mux_gpio_init_20:
   \   0000021A   9100....           LDS     R16, (OS_Global + 1)
   \   0000021E   7F00               ANDI    R16, 0xF0
   \   00000220   2300               TST     R16
   \   00000222   F021               BREQ    ??hart_gpio_mux_gpio_init_21
   \   00000224   E909               LDI     R16, 153
   \   00000226   E010               LDI     R17, 0
   \   00000228   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_21:
   \   0000022C   94F8               cli
   \   0000022E   9100....           LDS     R16, (OS_Global + 1)
   \   00000232   9503               INC     R16
   \   00000234   9300....           STS     (OS_Global + 1), R16
   \   00000238   9A38               SBI     0x07, 0x00
   \   0000023A   9100....           LDS     R16, (OS_Global + 1)
   \   0000023E   7F00               ANDI    R16, 0xF0
   \   00000240   2300               TST     R16
   \   00000242   F021               BREQ    ??hart_gpio_mux_gpio_init_22
   \   00000244   E909               LDI     R16, 153
   \   00000246   E010               LDI     R17, 0
   \   00000248   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_22:
   \   0000024C   9100....           LDS     R16, (OS_Global + 1)
   \   00000250   950A               DEC     R16
   \   00000252   9300....           STS     (OS_Global + 1), R16
   \   00000256   9100....           LDS     R16, (OS_Global + 1)
   \   0000025A   2300               TST     R16
   \   0000025C   F409               BRNE    ??hart_gpio_mux_gpio_init_23
   \   0000025E   9478               sei
    135              My_SetBit(DDRC, __BIT_MASK(1));    // ADDR1  : PC1 as output
   \                     ??hart_gpio_mux_gpio_init_23:
   \   00000260   9100....           LDS     R16, (OS_Global + 1)
   \   00000264   7F00               ANDI    R16, 0xF0
   \   00000266   2300               TST     R16
   \   00000268   F021               BREQ    ??hart_gpio_mux_gpio_init_24
   \   0000026A   E909               LDI     R16, 153
   \   0000026C   E010               LDI     R17, 0
   \   0000026E   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_24:
   \   00000272   94F8               cli
   \   00000274   9100....           LDS     R16, (OS_Global + 1)
   \   00000278   9503               INC     R16
   \   0000027A   9300....           STS     (OS_Global + 1), R16
   \   0000027E   9A39               SBI     0x07, 0x01
   \   00000280   9100....           LDS     R16, (OS_Global + 1)
   \   00000284   7F00               ANDI    R16, 0xF0
   \   00000286   2300               TST     R16
   \   00000288   F021               BREQ    ??hart_gpio_mux_gpio_init_25
   \   0000028A   E909               LDI     R16, 153
   \   0000028C   E010               LDI     R17, 0
   \   0000028E   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_gpio_init_25:
   \   00000292   9100....           LDS     R16, (OS_Global + 1)
   \   00000296   950A               DEC     R16
   \   00000298   9300....           STS     (OS_Global + 1), R16
   \   0000029C   9100....           LDS     R16, (OS_Global + 1)
   \   000002A0   2300               TST     R16
   \   000002A2   F409               BRNE    ??hart_gpio_mux_gpio_init_26
   \   000002A4   9478               sei
    136          }
   \                     ??hart_gpio_mux_gpio_init_26:
   \   000002A6   9508               RET
   \   000002A8                      REQUIRE _A_DDRD
   \   000002A8                      REQUIRE _A_DDRK
   \   000002A8                      REQUIRE _A_DDRH
   \   000002A8                      REQUIRE _A_DDRJ
   \   000002A8                      REQUIRE _A_DDRC
    137          

   \                                 In  segment CODE, align 2, keep-with-next
    138          void
    139          hart_gpio_mux_enable(hart_mux_t mux) {
   \                     hart_gpio_mux_enable:
   \   00000000   938A               ST      -Y, R24
   \   00000002   2F80               MOV     R24, R16
    140              switch ( mux ) {
   \   00000004   2F08               MOV     R16, R24
   \   00000006   5000               SUBI    R16, 0
   \   00000008   F031               BREQ    ??hart_gpio_mux_enable_0
   \   0000000A   950A               DEC     R16
   \   0000000C   F141               BREQ    ??hart_gpio_mux_enable_1
   \   0000000E   950A               DEC     R16
   \   00000010   F409               BRNE    $+2+2
   \   00000012   C04D               RJMP    ??hart_gpio_mux_enable_2
   \   00000014   C073               RJMP    ??hart_gpio_mux_enable_3
    141              case hart_mux_0:
    142                  My_SetBit(PORTD, __BIT_MASK(5));     // PD5
   \                     ??hart_gpio_mux_enable_0:
   \   00000016   9100....           LDS     R16, (OS_Global + 1)
   \   0000001A   7F00               ANDI    R16, 0xF0
   \   0000001C   2300               TST     R16
   \   0000001E   F021               BREQ    ??hart_gpio_mux_enable_4
   \   00000020   E909               LDI     R16, 153
   \   00000022   E010               LDI     R17, 0
   \   00000024   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_enable_4:
   \   00000028   94F8               cli
   \   0000002A   9100....           LDS     R16, (OS_Global + 1)
   \   0000002E   9503               INC     R16
   \   00000030   9300....           STS     (OS_Global + 1), R16
   \   00000034   9A5D               SBI     0x0B, 0x05
   \   00000036   9100....           LDS     R16, (OS_Global + 1)
   \   0000003A   7F00               ANDI    R16, 0xF0
   \   0000003C   2300               TST     R16
   \   0000003E   F021               BREQ    ??hart_gpio_mux_enable_5
   \   00000040   E909               LDI     R16, 153
   \   00000042   E010               LDI     R17, 0
   \   00000044   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_enable_5:
   \   00000048   9100....           LDS     R16, (OS_Global + 1)
   \   0000004C   950A               DEC     R16
   \   0000004E   9300....           STS     (OS_Global + 1), R16
   \   00000052   9100....           LDS     R16, (OS_Global + 1)
   \   00000056   2300               TST     R16
   \   00000058   F409               BRNE    ??hart_gpio_mux_enable_6
   \   0000005A   9478               sei
    143                  break;
   \                     ??hart_gpio_mux_enable_6:
   \   0000005C   C04F               RJMP    ??hart_gpio_mux_enable_3
    144          
    145              case hart_mux_1:
    146                  My_SetBit(PORTH, __BIT_MASK(3));     // PH3
   \                     ??hart_gpio_mux_enable_1:
   \   0000005E   9100....           LDS     R16, (OS_Global + 1)
   \   00000062   7F00               ANDI    R16, 0xF0
   \   00000064   2300               TST     R16
   \   00000066   F021               BREQ    ??hart_gpio_mux_enable_7
   \   00000068   E909               LDI     R16, 153
   \   0000006A   E010               LDI     R17, 0
   \   0000006C   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_enable_7:
   \   00000070   94F8               cli
   \   00000072   9100....           LDS     R16, (OS_Global + 1)
   \   00000076   9503               INC     R16
   \   00000078   9300....           STS     (OS_Global + 1), R16
   \   0000007C   91000102           LDS     R16, 258
   \   00000080   6008               ORI     R16, 0x08
   \   00000082   93000102           STS     258, R16
   \   00000086   9100....           LDS     R16, (OS_Global + 1)
   \   0000008A   7F00               ANDI    R16, 0xF0
   \   0000008C   2300               TST     R16
   \   0000008E   F021               BREQ    ??hart_gpio_mux_enable_8
   \   00000090   E909               LDI     R16, 153
   \   00000092   E010               LDI     R17, 0
   \   00000094   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_enable_8:
   \   00000098   9100....           LDS     R16, (OS_Global + 1)
   \   0000009C   950A               DEC     R16
   \   0000009E   9300....           STS     (OS_Global + 1), R16
   \   000000A2   9100....           LDS     R16, (OS_Global + 1)
   \   000000A6   2300               TST     R16
   \   000000A8   F549               BRNE    ??hart_gpio_mux_enable_3
   \   000000AA   9478               sei
    147                  break;
   \   000000AC   C027               RJMP    ??hart_gpio_mux_enable_3
    148          
    149              case hart_mux_2:
    150                  My_SetBit(PORTJ, __BIT_MASK(3));     // PJ3
   \                     ??hart_gpio_mux_enable_2:
   \   000000AE   9100....           LDS     R16, (OS_Global + 1)
   \   000000B2   7F00               ANDI    R16, 0xF0
   \   000000B4   2300               TST     R16
   \   000000B6   F021               BREQ    ??hart_gpio_mux_enable_9
   \   000000B8   E909               LDI     R16, 153
   \   000000BA   E010               LDI     R17, 0
   \   000000BC   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_enable_9:
   \   000000C0   94F8               cli
   \   000000C2   9100....           LDS     R16, (OS_Global + 1)
   \   000000C6   9503               INC     R16
   \   000000C8   9300....           STS     (OS_Global + 1), R16
   \   000000CC   91000105           LDS     R16, 261
   \   000000D0   6008               ORI     R16, 0x08
   \   000000D2   93000105           STS     261, R16
   \   000000D6   9100....           LDS     R16, (OS_Global + 1)
   \   000000DA   7F00               ANDI    R16, 0xF0
   \   000000DC   2300               TST     R16
   \   000000DE   F021               BREQ    ??hart_gpio_mux_enable_10
   \   000000E0   E909               LDI     R16, 153
   \   000000E2   E010               LDI     R17, 0
   \   000000E4   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_enable_10:
   \   000000E8   9100....           LDS     R16, (OS_Global + 1)
   \   000000EC   950A               DEC     R16
   \   000000EE   9300....           STS     (OS_Global + 1), R16
   \   000000F2   9100....           LDS     R16, (OS_Global + 1)
   \   000000F6   2300               TST     R16
   \   000000F8   F409               BRNE    ??hart_gpio_mux_enable_3
   \   000000FA   9478               sei
    151                  break;
    152              }
    153          }
   \                     ??hart_gpio_mux_enable_3:
   \   000000FC   9189               LD      R24, Y+
   \   000000FE   9508               RET
   \   00000100                      REQUIRE _A_PORTD
   \   00000100                      REQUIRE _A_PORTH
   \   00000100                      REQUIRE _A_PORTJ
    154          

   \                                 In  segment CODE, align 2, keep-with-next
    155          void
    156          hart_gpio_mux_disable(hart_mux_t mux) {
   \                     hart_gpio_mux_disable:
   \   00000000   938A               ST      -Y, R24
   \   00000002   2F80               MOV     R24, R16
    157              switch ( mux ) {
   \   00000004   2F08               MOV     R16, R24
   \   00000006   5000               SUBI    R16, 0
   \   00000008   F031               BREQ    ??hart_gpio_mux_disable_0
   \   0000000A   950A               DEC     R16
   \   0000000C   F141               BREQ    ??hart_gpio_mux_disable_1
   \   0000000E   950A               DEC     R16
   \   00000010   F409               BRNE    $+2+2
   \   00000012   C04D               RJMP    ??hart_gpio_mux_disable_2
   \   00000014   C073               RJMP    ??hart_gpio_mux_disable_3
    158              case hart_mux_0:
    159                  My_ClrBit(PORTD, __BIT_MASK(5));     // PD5
   \                     ??hart_gpio_mux_disable_0:
   \   00000016   9100....           LDS     R16, (OS_Global + 1)
   \   0000001A   7F00               ANDI    R16, 0xF0
   \   0000001C   2300               TST     R16
   \   0000001E   F021               BREQ    ??hart_gpio_mux_disable_4
   \   00000020   E909               LDI     R16, 153
   \   00000022   E010               LDI     R17, 0
   \   00000024   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_disable_4:
   \   00000028   94F8               cli
   \   0000002A   9100....           LDS     R16, (OS_Global + 1)
   \   0000002E   9503               INC     R16
   \   00000030   9300....           STS     (OS_Global + 1), R16
   \   00000034   985D               CBI     0x0B, 0x05
   \   00000036   9100....           LDS     R16, (OS_Global + 1)
   \   0000003A   7F00               ANDI    R16, 0xF0
   \   0000003C   2300               TST     R16
   \   0000003E   F021               BREQ    ??hart_gpio_mux_disable_5
   \   00000040   E909               LDI     R16, 153
   \   00000042   E010               LDI     R17, 0
   \   00000044   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_disable_5:
   \   00000048   9100....           LDS     R16, (OS_Global + 1)
   \   0000004C   950A               DEC     R16
   \   0000004E   9300....           STS     (OS_Global + 1), R16
   \   00000052   9100....           LDS     R16, (OS_Global + 1)
   \   00000056   2300               TST     R16
   \   00000058   F409               BRNE    ??hart_gpio_mux_disable_6
   \   0000005A   9478               sei
    160                  break;
   \                     ??hart_gpio_mux_disable_6:
   \   0000005C   C04F               RJMP    ??hart_gpio_mux_disable_3
    161          
    162              case hart_mux_1:
    163                  My_ClrBit(PORTH, __BIT_MASK(3));     // PH3
   \                     ??hart_gpio_mux_disable_1:
   \   0000005E   9100....           LDS     R16, (OS_Global + 1)
   \   00000062   7F00               ANDI    R16, 0xF0
   \   00000064   2300               TST     R16
   \   00000066   F021               BREQ    ??hart_gpio_mux_disable_7
   \   00000068   E909               LDI     R16, 153
   \   0000006A   E010               LDI     R17, 0
   \   0000006C   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_disable_7:
   \   00000070   94F8               cli
   \   00000072   9100....           LDS     R16, (OS_Global + 1)
   \   00000076   9503               INC     R16
   \   00000078   9300....           STS     (OS_Global + 1), R16
   \   0000007C   91000102           LDS     R16, 258
   \   00000080   7F07               ANDI    R16, 0xF7
   \   00000082   93000102           STS     258, R16
   \   00000086   9100....           LDS     R16, (OS_Global + 1)
   \   0000008A   7F00               ANDI    R16, 0xF0
   \   0000008C   2300               TST     R16
   \   0000008E   F021               BREQ    ??hart_gpio_mux_disable_8
   \   00000090   E909               LDI     R16, 153
   \   00000092   E010               LDI     R17, 0
   \   00000094   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_disable_8:
   \   00000098   9100....           LDS     R16, (OS_Global + 1)
   \   0000009C   950A               DEC     R16
   \   0000009E   9300....           STS     (OS_Global + 1), R16
   \   000000A2   9100....           LDS     R16, (OS_Global + 1)
   \   000000A6   2300               TST     R16
   \   000000A8   F549               BRNE    ??hart_gpio_mux_disable_3
   \   000000AA   9478               sei
    164                  break;
   \   000000AC   C027               RJMP    ??hart_gpio_mux_disable_3
    165          
    166              case hart_mux_2:
    167                  My_ClrBit(PORTJ, __BIT_MASK(3));     // PJ3
   \                     ??hart_gpio_mux_disable_2:
   \   000000AE   9100....           LDS     R16, (OS_Global + 1)
   \   000000B2   7F00               ANDI    R16, 0xF0
   \   000000B4   2300               TST     R16
   \   000000B6   F021               BREQ    ??hart_gpio_mux_disable_9
   \   000000B8   E909               LDI     R16, 153
   \   000000BA   E010               LDI     R17, 0
   \   000000BC   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_disable_9:
   \   000000C0   94F8               cli
   \   000000C2   9100....           LDS     R16, (OS_Global + 1)
   \   000000C6   9503               INC     R16
   \   000000C8   9300....           STS     (OS_Global + 1), R16
   \   000000CC   91000105           LDS     R16, 261
   \   000000D0   7F07               ANDI    R16, 0xF7
   \   000000D2   93000105           STS     261, R16
   \   000000D6   9100....           LDS     R16, (OS_Global + 1)
   \   000000DA   7F00               ANDI    R16, 0xF0
   \   000000DC   2300               TST     R16
   \   000000DE   F021               BREQ    ??hart_gpio_mux_disable_10
   \   000000E0   E909               LDI     R16, 153
   \   000000E2   E010               LDI     R17, 0
   \   000000E4   ........           CALL    OS_Error
   \                     ??hart_gpio_mux_disable_10:
   \   000000E8   9100....           LDS     R16, (OS_Global + 1)
   \   000000EC   950A               DEC     R16
   \   000000EE   9300....           STS     (OS_Global + 1), R16
   \   000000F2   9100....           LDS     R16, (OS_Global + 1)
   \   000000F6   2300               TST     R16
   \   000000F8   F409               BRNE    ??hart_gpio_mux_disable_3
   \   000000FA   9478               sei
    168                  break;
    169              }
    170          }
   \                     ??hart_gpio_mux_disable_3:
   \   000000FC   9189               LD      R24, Y+
   \   000000FE   9508               RET
   \   00000100                      REQUIRE _A_PORTD
   \   00000100                      REQUIRE _A_PORTH
   \   00000100                      REQUIRE _A_PORTJ
    171          
    172          /*
    173           * NOTE: XXX
    174           *
    175           * if you think disabling/enabling mux is not necessary during 
    176           * channel change, just remove it. I don't care.
    177           */

   \                                 In  segment CODE, align 2, keep-with-next
    178          void
    179          hart_gpio_channel_select(hart_channel_t chnl) {
   \                     hart_gpio_channel_select:
   \   00000000   ........           CALL    ?PROLOGUE3_L09
   \   00000004   2FA0               MOV     R26, R16
    180              switch ( chnl ) {
   \   00000006   2F0A               MOV     R16, R26
   \   00000008   5000               SUBI    R16, 0
   \   0000000A   5004               SUBI    R16, 4
   \   0000000C   F050               BRCS    ??hart_gpio_channel_select_0
   \   0000000E   5000               SUBI    R16, 0
   \   00000010   F038               BRCS    ??hart_gpio_channel_select_1
   \   00000012   5004               SUBI    R16, 4
   \   00000014   F180               BRCS    ??hart_gpio_channel_select_2
   \   00000016   5000               SUBI    R16, 0
   \   00000018   F018               BRCS    ??hart_gpio_channel_select_1
   \   0000001A   5004               SUBI    R16, 4
   \   0000001C   F408               BRCC    $+2+2
   \   0000001E   C059               RJMP    ??hart_gpio_channel_select_3
   \                     ??hart_gpio_channel_select_1:
   \   00000020   C080               RJMP    ??hart_gpio_channel_select_4
    181              case hart_channel_0:
    182              case hart_channel_1:
    183              case hart_channel_2:
    184              case hart_channel_3:
    185                  {
    186                      uint8_t chnl_mask = (uint8_t)(chnl - hart_channel_0);
   \                     ??hart_gpio_channel_select_0:
   \   00000022   2F9A               MOV     R25, R26
    187                      OS_IncDI();
   \   00000024   9100....           LDS     R16, (OS_Global + 1)
   \   00000028   7F00               ANDI    R16, 0xF0
   \   0000002A   2300               TST     R16
   \   0000002C   F021               BREQ    ??hart_gpio_channel_select_5
   \   0000002E   E909               LDI     R16, 153
   \   00000030   E010               LDI     R17, 0
   \   00000032   ........           CALL    OS_Error
   \                     ??hart_gpio_channel_select_5:
   \   00000036   94F8               cli
   \   00000038   9100....           LDS     R16, (OS_Global + 1)
   \   0000003C   9503               INC     R16
   \   0000003E   9300....           STS     (OS_Global + 1), R16
    188                      uint8_t tmpPort =  PORTK;
   \   00000042   9180....           LDS     R24, _A_PORTK
    189                      tmpPort &= ~(__BIT_MASK(0) | __BIT_MASK(1));
   \   00000046   7F8C               ANDI    R24, 0xFC
    190                      tmpPort |= chnl_mask << 0;
   \   00000048   2B89               OR      R24, R25
    191                      PORTK = tmpPort;
   \   0000004A   9380....           STS     _A_PORTK, R24
    192                      OS_DecRI();
   \   0000004E   9100....           LDS     R16, (OS_Global + 1)
   \   00000052   7F00               ANDI    R16, 0xF0
   \   00000054   2300               TST     R16
   \   00000056   F021               BREQ    ??hart_gpio_channel_select_6
   \   00000058   E909               LDI     R16, 153
   \   0000005A   E010               LDI     R17, 0
   \   0000005C   ........           CALL    OS_Error
   \                     ??hart_gpio_channel_select_6:
   \   00000060   9100....           LDS     R16, (OS_Global + 1)
   \   00000064   950A               DEC     R16
   \   00000066   9300....           STS     (OS_Global + 1), R16
   \   0000006A   9100....           LDS     R16, (OS_Global + 1)
   \   0000006E   2300               TST     R16
   \   00000070   F409               BRNE    ??hart_gpio_channel_select_7
   \   00000072   9478               sei
    193          
    194                      //My_ClrBit(PORTK, 3/* (__BIT_MASK(0) | __BIT_MASK(1))*/);     // clear first
    195                      //My_SetBit(PORTK, chnl_mask/*(chnl_mask << 0)*/);
    196                  }
    197                  break;
   \                     ??hart_gpio_channel_select_7:
   \   00000074   C056               RJMP    ??hart_gpio_channel_select_4
    198          
    199              case hart_channel_4:
    200              case hart_channel_5:
    201              case hart_channel_6:
    202              case hart_channel_7:
    203                  {
    204                      uint8_t chnl_mask = (uint8_t)(chnl - hart_channel_4);
   \                     ??hart_gpio_channel_select_2:
   \   00000076   2F8A               MOV     R24, R26
   \   00000078   5084               SUBI    R24, 4
    205                      OS_IncDI();
   \   0000007A   9100....           LDS     R16, (OS_Global + 1)
   \   0000007E   7F00               ANDI    R16, 0xF0
   \   00000080   2300               TST     R16
   \   00000082   F021               BREQ    ??hart_gpio_channel_select_8
   \   00000084   E909               LDI     R16, 153
   \   00000086   E010               LDI     R17, 0
   \   00000088   ........           CALL    OS_Error
   \                     ??hart_gpio_channel_select_8:
   \   0000008C   94F8               cli
   \   0000008E   9100....           LDS     R16, (OS_Global + 1)
   \   00000092   9503               INC     R16
   \   00000094   9300....           STS     (OS_Global + 1), R16
    206                      uint8_t tmpPort =  PORTK;
   \   00000098   9190....           LDS     R25, _A_PORTK
    207                      tmpPort &= ~(__BIT_MASK(4) | __BIT_MASK(5));
   \   0000009C   7C9F               ANDI    R25, 0xCF
    208                      tmpPort |= chnl_mask << 4;
   \   0000009E   2F08               MOV     R16, R24
   \   000000A0   9502               SWAP    R16
   \   000000A2   7F00               ANDI    R16, 0xF0
   \   000000A4   2B90               OR      R25, R16
    209                      PORTK = tmpPort;
   \   000000A6   9390....           STS     _A_PORTK, R25
    210                      OS_DecRI();
   \   000000AA   9100....           LDS     R16, (OS_Global + 1)
   \   000000AE   7F00               ANDI    R16, 0xF0
   \   000000B0   2300               TST     R16
   \   000000B2   F021               BREQ    ??hart_gpio_channel_select_9
   \   000000B4   E909               LDI     R16, 153
   \   000000B6   E010               LDI     R17, 0
   \   000000B8   ........           CALL    OS_Error
   \                     ??hart_gpio_channel_select_9:
   \   000000BC   9100....           LDS     R16, (OS_Global + 1)
   \   000000C0   950A               DEC     R16
   \   000000C2   9300....           STS     (OS_Global + 1), R16
   \   000000C6   9100....           LDS     R16, (OS_Global + 1)
   \   000000CA   2300               TST     R16
   \   000000CC   F551               BRNE    ??hart_gpio_channel_select_4
   \   000000CE   9478               sei
    211          
    212                      //My_ClrBit(PORTK, (__BIT_MASK(4) | __BIT_MASK(5)));     // clear first
    213                      //My_SetBit(PORTK, (chnl_mask << 4));                    // PK4/PK5
    214          
    215                  }
    216                  break;
   \   000000D0   C028               RJMP    ??hart_gpio_channel_select_4
    217          
    218              case hart_channel_8:
    219              case hart_channel_9:
    220              case hart_channel_10:
    221              case hart_channel_11:
    222                  {
    223                      uint8_t chnl_mask = (uint8_t)(chnl - hart_channel_8);
   \                     ??hart_gpio_channel_select_3:
   \   000000D2   2F8A               MOV     R24, R26
   \   000000D4   5088               SUBI    R24, 8
    224                      OS_IncDI();
   \   000000D6   9100....           LDS     R16, (OS_Global + 1)
   \   000000DA   7F00               ANDI    R16, 0xF0
   \   000000DC   2300               TST     R16
   \   000000DE   F021               BREQ    ??hart_gpio_channel_select_10
   \   000000E0   E909               LDI     R16, 153
   \   000000E2   E010               LDI     R17, 0
   \   000000E4   ........           CALL    OS_Error
   \                     ??hart_gpio_channel_select_10:
   \   000000E8   94F8               cli
   \   000000EA   9100....           LDS     R16, (OS_Global + 1)
   \   000000EE   9503               INC     R16
   \   000000F0   9300....           STS     (OS_Global + 1), R16
    225                      uint8_t tmpPort =  PORTC;
   \   000000F4   B198               IN      R25, 0x08
    226                      tmpPort &= ~(__BIT_MASK(0) | __BIT_MASK(1));
   \   000000F6   7F9C               ANDI    R25, 0xFC
    227                      tmpPort |= chnl_mask << 0;
   \   000000F8   2B98               OR      R25, R24
    228                      PORTC = tmpPort;
   \   000000FA   B998               OUT     0x08, R25
    229                      OS_DecRI();
   \   000000FC   9100....           LDS     R16, (OS_Global + 1)
   \   00000100   7F00               ANDI    R16, 0xF0
   \   00000102   2300               TST     R16
   \   00000104   F021               BREQ    ??hart_gpio_channel_select_11
   \   00000106   E909               LDI     R16, 153
   \   00000108   E010               LDI     R17, 0
   \   0000010A   ........           CALL    OS_Error
   \                     ??hart_gpio_channel_select_11:
   \   0000010E   9100....           LDS     R16, (OS_Global + 1)
   \   00000112   950A               DEC     R16
   \   00000114   9300....           STS     (OS_Global + 1), R16
   \   00000118   9100....           LDS     R16, (OS_Global + 1)
   \   0000011C   2300               TST     R16
   \   0000011E   F409               BRNE    ??hart_gpio_channel_select_4
   \   00000120   9478               sei
    230          
    231                      //My_ClrBit(PORTC, (__BIT_MASK(0) | __BIT_MASK(1)));     // clear first
    232                      //My_SetBit(PORTC, (chnl_mask << 0));                    // PC0/PC1
    233                  }
    234                  break;
    235              }
    236          }
   \                     ??hart_gpio_channel_select_4:
   \   00000122   E0E3               LDI     R30, 3
   \   00000124   ........           JMP     ?EPILOGUE_B3_L09
   \   00000128                      REQUIRE _A_PORTK
   \   00000128                      REQUIRE _A_PORTC
    237          
    238          
    239          
    240          /*
    241           * NOTE: XXX
    242           *
    243           * Enable all mux for HART
    244           *
    245           */

   \                                 In  segment CODE, align 2, keep-with-next
    246          void hart_gpio_enable_all_mux(void) {
   \                     hart_gpio_enable_all_mux:
    247          
    248              hart_gpio_mux_enable(hart_mux_0);
   \   00000000   E000               LDI     R16, 0
   \   00000002   ....               RCALL   hart_gpio_mux_enable
    249              hart_gpio_mux_enable(hart_mux_1);
   \   00000004   E001               LDI     R16, 1
   \   00000006   ....               RCALL   hart_gpio_mux_enable
    250              hart_gpio_mux_enable(hart_mux_2);
   \   00000008   E002               LDI     R16, 2
   \   0000000A   ....               RCALL   hart_gpio_mux_enable
    251          }
   \   0000000C   9508               RET
    252          
    253          ////////////////////////////////////////////////////////////////////////////////
    254          //
    255          // ADC & ADC MUX
    256          //
    257          ////////////////////////////////////////////////////////////////////////////////
    258          /*
    259           *
    260           * ADC MUX
    261           * ADR0       : PF0
    262           * ADR1       : PF1
    263           * ADR2       : PF2
    264           * ADR3       : PF3
    265           *
    266           * ADC SPI
    267           *
    268           * SCLK       : PL0
    269           * MISO       : PL1
    270           * MOSI       : PL2
    271           * CS         : N/A. always selected
    272           * /RESET     : PL3
    273           * /DRDY      : PD0, PD0 is mapped to EINT0 when set up as input
    274           *
    275           */

   \                                 In  segment CODE, align 2, keep-with-next
    276          static void
    277          hart_gpio_adc_gpio_init(void) {
   \                     hart_gpio_adc_gpio_init:
    278              My_SetBit(DDRF,  0x0f);              // PF0-PF3 as output
   \   00000000   9100....           LDS     R16, (OS_Global + 1)
   \   00000004   7F00               ANDI    R16, 0xF0
   \   00000006   2300               TST     R16
   \   00000008   F021               BREQ    ??hart_gpio_adc_gpio_init_0
   \   0000000A   E909               LDI     R16, 153
   \   0000000C   E010               LDI     R17, 0
   \   0000000E   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_0:
   \   00000012   94F8               cli
   \   00000014   9100....           LDS     R16, (OS_Global + 1)
   \   00000018   9503               INC     R16
   \   0000001A   9300....           STS     (OS_Global + 1), R16
   \   0000001E   B300               IN      R16, 0x10
   \   00000020   600F               ORI     R16, 0x0F
   \   00000022   BB00               OUT     0x10, R16
   \   00000024   9100....           LDS     R16, (OS_Global + 1)
   \   00000028   7F00               ANDI    R16, 0xF0
   \   0000002A   2300               TST     R16
   \   0000002C   F021               BREQ    ??hart_gpio_adc_gpio_init_1
   \   0000002E   E909               LDI     R16, 153
   \   00000030   E010               LDI     R17, 0
   \   00000032   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_1:
   \   00000036   9100....           LDS     R16, (OS_Global + 1)
   \   0000003A   950A               DEC     R16
   \   0000003C   9300....           STS     (OS_Global + 1), R16
   \   00000040   9100....           LDS     R16, (OS_Global + 1)
   \   00000044   2300               TST     R16
   \   00000046   F409               BRNE    ??hart_gpio_adc_gpio_init_2
   \   00000048   9478               sei
    279              // Port F data direction, used for ADC
    280              My_SetBit(DDRL,  AD7715_SCLK);       // SCLK   : PL0 as output
   \                     ??hart_gpio_adc_gpio_init_2:
   \   0000004A   9100....           LDS     R16, (OS_Global + 1)
   \   0000004E   7F00               ANDI    R16, 0xF0
   \   00000050   2300               TST     R16
   \   00000052   F021               BREQ    ??hart_gpio_adc_gpio_init_3
   \   00000054   E909               LDI     R16, 153
   \   00000056   E010               LDI     R17, 0
   \   00000058   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_3:
   \   0000005C   94F8               cli
   \   0000005E   9100....           LDS     R16, (OS_Global + 1)
   \   00000062   9503               INC     R16
   \   00000064   9300....           STS     (OS_Global + 1), R16
   \   00000068   9100010A           LDS     R16, 266
   \   0000006C   6001               ORI     R16, 0x01
   \   0000006E   9300010A           STS     266, R16
   \   00000072   9100....           LDS     R16, (OS_Global + 1)
   \   00000076   7F00               ANDI    R16, 0xF0
   \   00000078   2300               TST     R16
   \   0000007A   F021               BREQ    ??hart_gpio_adc_gpio_init_4
   \   0000007C   E909               LDI     R16, 153
   \   0000007E   E010               LDI     R17, 0
   \   00000080   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_4:
   \   00000084   9100....           LDS     R16, (OS_Global + 1)
   \   00000088   950A               DEC     R16
   \   0000008A   9300....           STS     (OS_Global + 1), R16
   \   0000008E   9100....           LDS     R16, (OS_Global + 1)
   \   00000092   2300               TST     R16
   \   00000094   F409               BRNE    ??hart_gpio_adc_gpio_init_5
   \   00000096   9478               sei
    281              My_ClrBit(DDRL,  AD7715_MISO);       // MISO   : PL1 as input
   \                     ??hart_gpio_adc_gpio_init_5:
   \   00000098   9100....           LDS     R16, (OS_Global + 1)
   \   0000009C   7F00               ANDI    R16, 0xF0
   \   0000009E   2300               TST     R16
   \   000000A0   F021               BREQ    ??hart_gpio_adc_gpio_init_6
   \   000000A2   E909               LDI     R16, 153
   \   000000A4   E010               LDI     R17, 0
   \   000000A6   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_6:
   \   000000AA   94F8               cli
   \   000000AC   9100....           LDS     R16, (OS_Global + 1)
   \   000000B0   9503               INC     R16
   \   000000B2   9300....           STS     (OS_Global + 1), R16
   \   000000B6   9100010A           LDS     R16, 266
   \   000000BA   7F0D               ANDI    R16, 0xFD
   \   000000BC   9300010A           STS     266, R16
   \   000000C0   9100....           LDS     R16, (OS_Global + 1)
   \   000000C4   7F00               ANDI    R16, 0xF0
   \   000000C6   2300               TST     R16
   \   000000C8   F021               BREQ    ??hart_gpio_adc_gpio_init_7
   \   000000CA   E909               LDI     R16, 153
   \   000000CC   E010               LDI     R17, 0
   \   000000CE   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_7:
   \   000000D2   9100....           LDS     R16, (OS_Global + 1)
   \   000000D6   950A               DEC     R16
   \   000000D8   9300....           STS     (OS_Global + 1), R16
   \   000000DC   9100....           LDS     R16, (OS_Global + 1)
   \   000000E0   2300               TST     R16
   \   000000E2   F409               BRNE    ??hart_gpio_adc_gpio_init_8
   \   000000E4   9478               sei
    282              My_SetBit(DDRL,  AD7715_MOSI);       // MOSI   : PL2 as output
   \                     ??hart_gpio_adc_gpio_init_8:
   \   000000E6   9100....           LDS     R16, (OS_Global + 1)
   \   000000EA   7F00               ANDI    R16, 0xF0
   \   000000EC   2300               TST     R16
   \   000000EE   F021               BREQ    ??hart_gpio_adc_gpio_init_9
   \   000000F0   E909               LDI     R16, 153
   \   000000F2   E010               LDI     R17, 0
   \   000000F4   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_9:
   \   000000F8   94F8               cli
   \   000000FA   9100....           LDS     R16, (OS_Global + 1)
   \   000000FE   9503               INC     R16
   \   00000100   9300....           STS     (OS_Global + 1), R16
   \   00000104   9100010A           LDS     R16, 266
   \   00000108   6004               ORI     R16, 0x04
   \   0000010A   9300010A           STS     266, R16
   \   0000010E   9100....           LDS     R16, (OS_Global + 1)
   \   00000112   7F00               ANDI    R16, 0xF0
   \   00000114   2300               TST     R16
   \   00000116   F021               BREQ    ??hart_gpio_adc_gpio_init_10
   \   00000118   E909               LDI     R16, 153
   \   0000011A   E010               LDI     R17, 0
   \   0000011C   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_10:
   \   00000120   9100....           LDS     R16, (OS_Global + 1)
   \   00000124   950A               DEC     R16
   \   00000126   9300....           STS     (OS_Global + 1), R16
   \   0000012A   9100....           LDS     R16, (OS_Global + 1)
   \   0000012E   2300               TST     R16
   \   00000130   F409               BRNE    ??hart_gpio_adc_gpio_init_11
   \   00000132   9478               sei
    283              My_SetBit(DDRL,  __BIT_MASK(3));     // /RESET : PL3 as output
   \                     ??hart_gpio_adc_gpio_init_11:
   \   00000134   9100....           LDS     R16, (OS_Global + 1)
   \   00000138   7F00               ANDI    R16, 0xF0
   \   0000013A   2300               TST     R16
   \   0000013C   F021               BREQ    ??hart_gpio_adc_gpio_init_12
   \   0000013E   E909               LDI     R16, 153
   \   00000140   E010               LDI     R17, 0
   \   00000142   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_12:
   \   00000146   94F8               cli
   \   00000148   9100....           LDS     R16, (OS_Global + 1)
   \   0000014C   9503               INC     R16
   \   0000014E   9300....           STS     (OS_Global + 1), R16
   \   00000152   9100010A           LDS     R16, 266
   \   00000156   6008               ORI     R16, 0x08
   \   00000158   9300010A           STS     266, R16
   \   0000015C   9100....           LDS     R16, (OS_Global + 1)
   \   00000160   7F00               ANDI    R16, 0xF0
   \   00000162   2300               TST     R16
   \   00000164   F021               BREQ    ??hart_gpio_adc_gpio_init_13
   \   00000166   E909               LDI     R16, 153
   \   00000168   E010               LDI     R17, 0
   \   0000016A   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_13:
   \   0000016E   9100....           LDS     R16, (OS_Global + 1)
   \   00000172   950A               DEC     R16
   \   00000174   9300....           STS     (OS_Global + 1), R16
   \   00000178   9100....           LDS     R16, (OS_Global + 1)
   \   0000017C   2300               TST     R16
   \   0000017E   F409               BRNE    ??hart_gpio_adc_gpio_init_14
   \   00000180   9478               sei
    284              My_ClrBit(DDRD,  __BIT_MASK(0));     // /DRDY  : PD0 as input
   \                     ??hart_gpio_adc_gpio_init_14:
   \   00000182   9100....           LDS     R16, (OS_Global + 1)
   \   00000186   7F00               ANDI    R16, 0xF0
   \   00000188   2300               TST     R16
   \   0000018A   F021               BREQ    ??hart_gpio_adc_gpio_init_15
   \   0000018C   E909               LDI     R16, 153
   \   0000018E   E010               LDI     R17, 0
   \   00000190   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_15:
   \   00000194   94F8               cli
   \   00000196   9100....           LDS     R16, (OS_Global + 1)
   \   0000019A   9503               INC     R16
   \   0000019C   9300....           STS     (OS_Global + 1), R16
   \   000001A0   9850               CBI     0x0A, 0x00
   \   000001A2   9100....           LDS     R16, (OS_Global + 1)
   \   000001A6   7F00               ANDI    R16, 0xF0
   \   000001A8   2300               TST     R16
   \   000001AA   F021               BREQ    ??hart_gpio_adc_gpio_init_16
   \   000001AC   E909               LDI     R16, 153
   \   000001AE   E010               LDI     R17, 0
   \   000001B0   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_16:
   \   000001B4   9100....           LDS     R16, (OS_Global + 1)
   \   000001B8   950A               DEC     R16
   \   000001BA   9300....           STS     (OS_Global + 1), R16
   \   000001BE   9100....           LDS     R16, (OS_Global + 1)
   \   000001C2   2300               TST     R16
   \   000001C4   F409               BRNE    ??hart_gpio_adc_gpio_init_17
   \   000001C6   9478               sei
    285          
    286              //
    287              // setup clock high
    288              //
    289              My_SetBit(AD7715_PORT, AD7715_SCLK);
   \                     ??hart_gpio_adc_gpio_init_17:
   \   000001C8   9100....           LDS     R16, (OS_Global + 1)
   \   000001CC   7F00               ANDI    R16, 0xF0
   \   000001CE   2300               TST     R16
   \   000001D0   F021               BREQ    ??hart_gpio_adc_gpio_init_18
   \   000001D2   E909               LDI     R16, 153
   \   000001D4   E010               LDI     R17, 0
   \   000001D6   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_18:
   \   000001DA   94F8               cli
   \   000001DC   9100....           LDS     R16, (OS_Global + 1)
   \   000001E0   9503               INC     R16
   \   000001E2   9300....           STS     (OS_Global + 1), R16
   \   000001E6   9100010B           LDS     R16, 267
   \   000001EA   6001               ORI     R16, 0x01
   \   000001EC   9300010B           STS     267, R16
   \   000001F0   9100....           LDS     R16, (OS_Global + 1)
   \   000001F4   7F00               ANDI    R16, 0xF0
   \   000001F6   2300               TST     R16
   \   000001F8   F021               BREQ    ??hart_gpio_adc_gpio_init_19
   \   000001FA   E909               LDI     R16, 153
   \   000001FC   E010               LDI     R17, 0
   \   000001FE   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_gpio_init_19:
   \   00000202   9100....           LDS     R16, (OS_Global + 1)
   \   00000206   950A               DEC     R16
   \   00000208   9300....           STS     (OS_Global + 1), R16
   \   0000020C   9100....           LDS     R16, (OS_Global + 1)
   \   00000210   2300               TST     R16
   \   00000212   F409               BRNE    ??hart_gpio_adc_gpio_init_20
   \   00000214   9478               sei
    290          
    291              //
    292              // put ADC in reset state
    293              //
    294              hart_gpio_adc_reset(0);
   \                     ??hart_gpio_adc_gpio_init_20:
   \   00000216   E000               LDI     R16, 0
   \   00000218   ....               RCALL   hart_gpio_adc_reset
    295          }
   \   0000021A   9508               RET
   \   0000021C                      REQUIRE _A_DDRF
   \   0000021C                      REQUIRE _A_DDRL
   \   0000021C                      REQUIRE _A_DDRD
   \   0000021C                      REQUIRE _A_PORTL
    296          

   \                                 In  segment CODE, align 2, keep-with-next
    297          void hart_gpio_adc_channel_select(hart_channel_t chnl) {
   \                     hart_gpio_adc_channel_select:
    298              uint8_t   mask    = (uint8_t)(chnl - hart_channel_0);
    299              // No protection needed as exclusive use
    300              //OS_EnterRegion();
    301              //OS_IncDI();
    302              uint8_t tmpReg = PORTF;
   \   00000000   B311               IN      R17, 0x11
    303              tmpReg &= ~0x0f;         // clear
   \   00000002   7F10               ANDI    R17, 0xF0
    304              tmpReg |=  mask;         // set
   \   00000004   2B10               OR      R17, R16
    305              PORTF = tmpReg;
   \   00000006   BB11               OUT     0x11, R17
    306              //OS_LeaveRegion();
    307              //OS_DecRI();
    308          }
   \   00000008   9508               RET
   \   0000000A                      REQUIRE _A_PORTF
    309          

   \                                 In  segment CODE, align 2, keep-with-next
    310          void hart_gpio_adc_reset(uint8_t hi) {
   \                     hart_gpio_adc_reset:
   \   00000000   938A               ST      -Y, R24
   \   00000002   2F80               MOV     R24, R16
    311              if ( hi ) {
   \   00000004   2388               TST     R24
   \   00000006   F141               BREQ    ??hart_gpio_adc_reset_0
    312                  My_SetBit(AD7715_PORT, __BIT_MASK(3));
   \   00000008   9100....           LDS     R16, (OS_Global + 1)
   \   0000000C   7F00               ANDI    R16, 0xF0
   \   0000000E   2300               TST     R16
   \   00000010   F021               BREQ    ??hart_gpio_adc_reset_1
   \   00000012   E909               LDI     R16, 153
   \   00000014   E010               LDI     R17, 0
   \   00000016   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_reset_1:
   \   0000001A   94F8               cli
   \   0000001C   9100....           LDS     R16, (OS_Global + 1)
   \   00000020   9503               INC     R16
   \   00000022   9300....           STS     (OS_Global + 1), R16
   \   00000026   9100010B           LDS     R16, 267
   \   0000002A   6008               ORI     R16, 0x08
   \   0000002C   9300010B           STS     267, R16
   \   00000030   9100....           LDS     R16, (OS_Global + 1)
   \   00000034   7F00               ANDI    R16, 0xF0
   \   00000036   2300               TST     R16
   \   00000038   F021               BREQ    ??hart_gpio_adc_reset_2
   \   0000003A   E909               LDI     R16, 153
   \   0000003C   E010               LDI     R17, 0
   \   0000003E   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_reset_2:
   \   00000042   9100....           LDS     R16, (OS_Global + 1)
   \   00000046   950A               DEC     R16
   \   00000048   9300....           STS     (OS_Global + 1), R16
   \   0000004C   9100....           LDS     R16, (OS_Global + 1)
   \   00000050   2300               TST     R16
   \   00000052   F549               BRNE    ??hart_gpio_adc_reset_3
   \   00000054   9478               sei
   \   00000056   C027               RJMP    ??hart_gpio_adc_reset_3
    313              } else {
    314                  My_ClrBit(AD7715_PORT, __BIT_MASK(3));
   \                     ??hart_gpio_adc_reset_0:
   \   00000058   9100....           LDS     R16, (OS_Global + 1)
   \   0000005C   7F00               ANDI    R16, 0xF0
   \   0000005E   2300               TST     R16
   \   00000060   F021               BREQ    ??hart_gpio_adc_reset_4
   \   00000062   E909               LDI     R16, 153
   \   00000064   E010               LDI     R17, 0
   \   00000066   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_reset_4:
   \   0000006A   94F8               cli
   \   0000006C   9100....           LDS     R16, (OS_Global + 1)
   \   00000070   9503               INC     R16
   \   00000072   9300....           STS     (OS_Global + 1), R16
   \   00000076   9100010B           LDS     R16, 267
   \   0000007A   7F07               ANDI    R16, 0xF7
   \   0000007C   9300010B           STS     267, R16
   \   00000080   9100....           LDS     R16, (OS_Global + 1)
   \   00000084   7F00               ANDI    R16, 0xF0
   \   00000086   2300               TST     R16
   \   00000088   F021               BREQ    ??hart_gpio_adc_reset_5
   \   0000008A   E909               LDI     R16, 153
   \   0000008C   E010               LDI     R17, 0
   \   0000008E   ........           CALL    OS_Error
   \                     ??hart_gpio_adc_reset_5:
   \   00000092   9100....           LDS     R16, (OS_Global + 1)
   \   00000096   950A               DEC     R16
   \   00000098   9300....           STS     (OS_Global + 1), R16
   \   0000009C   9100....           LDS     R16, (OS_Global + 1)
   \   000000A0   2300               TST     R16
   \   000000A2   F409               BRNE    ??hart_gpio_adc_reset_3
   \   000000A4   9478               sei
    315              }
    316          }
   \                     ??hart_gpio_adc_reset_3:
   \   000000A6   9189               LD      R24, Y+
   \   000000A8   9508               RET
   \   000000AA                      REQUIRE _A_PORTL
    317          
    318          ////////////////////////////////////////////////////////////////////////////////
    319          //
    320          // HART Modem Control
    321          //
    322          ////////////////////////////////////////////////////////////////////////////////
    323          /*
    324           *
    325           * MODEM0 /RTS : PD4
    326           * MODEM1 /RTS : PH2
    327           * MODEM2 /RTS : PJ2
    328           *
    329           */

   \                                 In  segment CODE, align 2, keep-with-next
    330          static void hart_gpio_modem_gpio_init(void) {
   \                     hart_gpio_modem_gpio_init:
    331              My_SetBit(DDRD,  __BIT_MASK(4));     // MODEM0 /RTS: PD4 as output
   \   00000000   9100....           LDS     R16, (OS_Global + 1)
   \   00000004   7F00               ANDI    R16, 0xF0
   \   00000006   2300               TST     R16
   \   00000008   F021               BREQ    ??hart_gpio_modem_gpio_init_0
   \   0000000A   E909               LDI     R16, 153
   \   0000000C   E010               LDI     R17, 0
   \   0000000E   ........           CALL    OS_Error
   \                     ??hart_gpio_modem_gpio_init_0:
   \   00000012   94F8               cli
   \   00000014   9100....           LDS     R16, (OS_Global + 1)
   \   00000018   9503               INC     R16
   \   0000001A   9300....           STS     (OS_Global + 1), R16
   \   0000001E   9A54               SBI     0x0A, 0x04
   \   00000020   9100....           LDS     R16, (OS_Global + 1)
   \   00000024   7F00               ANDI    R16, 0xF0
   \   00000026   2300               TST     R16
   \   00000028   F021               BREQ    ??hart_gpio_modem_gpio_init_1
   \   0000002A   E909               LDI     R16, 153
   \   0000002C   E010               LDI     R17, 0
   \   0000002E   ........           CALL    OS_Error
   \                     ??hart_gpio_modem_gpio_init_1:
   \   00000032   9100....           LDS     R16, (OS_Global + 1)
   \   00000036   950A               DEC     R16
   \   00000038   9300....           STS     (OS_Global + 1), R16
   \   0000003C   9100....           LDS     R16, (OS_Global + 1)
   \   00000040   2300               TST     R16
   \   00000042   F409               BRNE    ??hart_gpio_modem_gpio_init_2
   \   00000044   9478               sei
    332              My_SetBit(DDRH,  __BIT_MASK(2));     // MODEM1 /RTS: PH2 as output
   \                     ??hart_gpio_modem_gpio_init_2:
   \   00000046   9100....           LDS     R16, (OS_Global + 1)
   \   0000004A   7F00               ANDI    R16, 0xF0
   \   0000004C   2300               TST     R16
   \   0000004E   F021               BREQ    ??hart_gpio_modem_gpio_init_3
   \   00000050   E909               LDI     R16, 153
   \   00000052   E010               LDI     R17, 0
   \   00000054   ........           CALL    OS_Error
   \                     ??hart_gpio_modem_gpio_init_3:
   \   00000058   94F8               cli
   \   0000005A   9100....           LDS     R16, (OS_Global + 1)
   \   0000005E   9503               INC     R16
   \   00000060   9300....           STS     (OS_Global + 1), R16
   \   00000064   91000101           LDS     R16, 257
   \   00000068   6004               ORI     R16, 0x04
   \   0000006A   93000101           STS     257, R16
   \   0000006E   9100....           LDS     R16, (OS_Global + 1)
   \   00000072   7F00               ANDI    R16, 0xF0
   \   00000074   2300               TST     R16
   \   00000076   F021               BREQ    ??hart_gpio_modem_gpio_init_4
   \   00000078   E909               LDI     R16, 153
   \   0000007A   E010               LDI     R17, 0
   \   0000007C   ........           CALL    OS_Error
   \                     ??hart_gpio_modem_gpio_init_4:
   \   00000080   9100....           LDS     R16, (OS_Global + 1)
   \   00000084   950A               DEC     R16
   \   00000086   9300....           STS     (OS_Global + 1), R16
   \   0000008A   9100....           LDS     R16, (OS_Global + 1)
   \   0000008E   2300               TST     R16
   \   00000090   F409               BRNE    ??hart_gpio_modem_gpio_init_5
   \   00000092   9478               sei
    333              My_SetBit(DDRJ,  __BIT_MASK(2));     // MODEM2 /RTS: PJ2 as output
   \                     ??hart_gpio_modem_gpio_init_5:
   \   00000094   9100....           LDS     R16, (OS_Global + 1)
   \   00000098   7F00               ANDI    R16, 0xF0
   \   0000009A   2300               TST     R16
   \   0000009C   F021               BREQ    ??hart_gpio_modem_gpio_init_6
   \   0000009E   E909               LDI     R16, 153
   \   000000A0   E010               LDI     R17, 0
   \   000000A2   ........           CALL    OS_Error
   \                     ??hart_gpio_modem_gpio_init_6:
   \   000000A6   94F8               cli
   \   000000A8   9100....           LDS     R16, (OS_Global + 1)
   \   000000AC   9503               INC     R16
   \   000000AE   9300....           STS     (OS_Global + 1), R16
   \   000000B2   91000104           LDS     R16, 260
   \   000000B6   6004               ORI     R16, 0x04
   \   000000B8   93000104           STS     260, R16
   \   000000BC   9100....           LDS     R16, (OS_Global + 1)
   \   000000C0   7F00               ANDI    R16, 0xF0
   \   000000C2   2300               TST     R16
   \   000000C4   F021               BREQ    ??hart_gpio_modem_gpio_init_7
   \   000000C6   E909               LDI     R16, 153
   \   000000C8   E010               LDI     R17, 0
   \   000000CA   ........           CALL    OS_Error
   \                     ??hart_gpio_modem_gpio_init_7:
   \   000000CE   9100....           LDS     R16, (OS_Global + 1)
   \   000000D2   950A               DEC     R16
   \   000000D4   9300....           STS     (OS_Global + 1), R16
   \   000000D8   9100....           LDS     R16, (OS_Global + 1)
   \   000000DC   2300               TST     R16
   \   000000DE   F409               BRNE    ??hart_gpio_modem_gpio_init_8
   \   000000E0   9478               sei
    334          
    335              hart_gpio_hart_carrier_off(hart_modem_0);
   \                     ??hart_gpio_modem_gpio_init_8:
   \   000000E2   E000               LDI     R16, 0
   \   000000E4   ....               RCALL   hart_gpio_hart_carrier_off
    336              hart_gpio_hart_carrier_off(hart_modem_1);
   \   000000E6   E001               LDI     R16, 1
   \   000000E8   ....               RCALL   hart_gpio_hart_carrier_off
    337              hart_gpio_hart_carrier_off(hart_modem_2);
   \   000000EA   E002               LDI     R16, 2
   \   000000EC   ....               RCALL   hart_gpio_hart_carrier_off
    338          }
   \   000000EE   9508               RET
   \   000000F0                      REQUIRE _A_DDRD
   \   000000F0                      REQUIRE _A_DDRH
   \   000000F0                      REQUIRE _A_DDRJ
    339          

   \                                 In  segment CODE, align 2, keep-with-next
    340          void hart_gpio_hart_carrier_off(hart_modem_t modem) {
   \                     hart_gpio_hart_carrier_off:
   \   00000000   938A               ST      -Y, R24
   \   00000002   2F80               MOV     R24, R16
    341              OS_IncDI();
   \   00000004   9100....           LDS     R16, (OS_Global + 1)
   \   00000008   7F00               ANDI    R16, 0xF0
   \   0000000A   2300               TST     R16
   \   0000000C   F021               BREQ    ??hart_gpio_hart_carrier_off_0
   \   0000000E   E909               LDI     R16, 153
   \   00000010   E010               LDI     R17, 0
   \   00000012   ........           CALL    OS_Error
   \                     ??hart_gpio_hart_carrier_off_0:
   \   00000016   94F8               cli
   \   00000018   9100....           LDS     R16, (OS_Global + 1)
   \   0000001C   9503               INC     R16
   \   0000001E   9300....           STS     (OS_Global + 1), R16
    342              hart_gpio_hart_carrier_off_irq(modem);
   \   00000022   2F08               MOV     R16, R24
   \   00000024   ....               RCALL   hart_gpio_hart_carrier_off_irq
    343              OS_DecRI();
   \   00000026   9100....           LDS     R16, (OS_Global + 1)
   \   0000002A   7F00               ANDI    R16, 0xF0
   \   0000002C   2300               TST     R16
   \   0000002E   F021               BREQ    ??hart_gpio_hart_carrier_off_1
   \   00000030   E909               LDI     R16, 153
   \   00000032   E010               LDI     R17, 0
   \   00000034   ........           CALL    OS_Error
   \                     ??hart_gpio_hart_carrier_off_1:
   \   00000038   9100....           LDS     R16, (OS_Global + 1)
   \   0000003C   950A               DEC     R16
   \   0000003E   9300....           STS     (OS_Global + 1), R16
   \   00000042   9100....           LDS     R16, (OS_Global + 1)
   \   00000046   2300               TST     R16
   \   00000048   F409               BRNE    ??hart_gpio_hart_carrier_off_2
   \   0000004A   9478               sei
    344          }
   \                     ??hart_gpio_hart_carrier_off_2:
   \   0000004C   9189               LD      R24, Y+
   \   0000004E   9508               RET
    345          

   \                                 In  segment CODE, align 2, keep-with-next
    346          void hart_gpio_hart_carrier_off_irq(hart_modem_t modem) {
   \                     hart_gpio_hart_carrier_off_irq:
    347              switch ( modem ) {
   \   00000000   2F10               MOV     R17, R16
   \   00000002   5010               SUBI    R17, 0
   \   00000004   F029               BREQ    ??hart_gpio_hart_carrier_off_irq_0
   \   00000006   951A               DEC     R17
   \   00000008   F039               BREQ    ??hart_gpio_hart_carrier_off_irq_1
   \   0000000A   951A               DEC     R17
   \   0000000C   F059               BREQ    ??hart_gpio_hart_carrier_off_irq_2
   \   0000000E   9508               RET
    348              case hart_modem_0:
    349                  {
    350                      uint8_t tmpReg = PORTD;
   \                     ??hart_gpio_hart_carrier_off_irq_0:
   \   00000010   B11B               IN      R17, 0x0B
    351                      tmpReg |= __BIT_MASK(4);
   \   00000012   6110               ORI     R17, 0x10
    352                      PORTD = tmpReg;
   \   00000014   B91B               OUT     0x0B, R17
    353                  }
    354                  break;
   \   00000016   9508               RET
    355          
    356              case hart_modem_1:
    357                  {
    358                      uint8_t tmpReg = PORTH;
   \                     ??hart_gpio_hart_carrier_off_irq_1:
   \   00000018   9110....           LDS     R17, _A_PORTH
    359                      tmpReg |= __BIT_MASK(2);
   \   0000001C   6014               ORI     R17, 0x04
    360                      PORTH = tmpReg;
   \   0000001E   9310....           STS     _A_PORTH, R17
    361                  }
    362                  break;
   \   00000022   9508               RET
    363          
    364              case hart_modem_2:
    365                  {
    366                      uint8_t tmpReg = PORTJ;
   \                     ??hart_gpio_hart_carrier_off_irq_2:
   \   00000024   9110....           LDS     R17, _A_PORTJ
    367                      tmpReg |= __BIT_MASK(2);
   \   00000028   6014               ORI     R17, 0x04
    368                      PORTJ = tmpReg;
   \   0000002A   9310....           STS     _A_PORTJ, R17
    369                  }
    370                  break;
    371              }
    372          }
   \   0000002E   9508               RET
   \   00000030                      REQUIRE _A_PORTD
   \   00000030                      REQUIRE _A_PORTH
   \   00000030                      REQUIRE _A_PORTJ
    373          

   \                                 In  segment CODE, align 2, keep-with-next
    374          void hart_gpio_hart_carrier_on(hart_modem_t modem) {
   \                     hart_gpio_hart_carrier_on:
   \   00000000   938A               ST      -Y, R24
   \   00000002   2F80               MOV     R24, R16
    375              OS_IncDI();
   \   00000004   9100....           LDS     R16, (OS_Global + 1)
   \   00000008   7F00               ANDI    R16, 0xF0
   \   0000000A   2300               TST     R16
   \   0000000C   F021               BREQ    ??hart_gpio_hart_carrier_on_0
   \   0000000E   E909               LDI     R16, 153
   \   00000010   E010               LDI     R17, 0
   \   00000012   ........           CALL    OS_Error
   \                     ??hart_gpio_hart_carrier_on_0:
   \   00000016   94F8               cli
   \   00000018   9100....           LDS     R16, (OS_Global + 1)
   \   0000001C   9503               INC     R16
   \   0000001E   9300....           STS     (OS_Global + 1), R16
    376              hart_gpio_hart_carrier_on_irq(modem);
   \   00000022   2F08               MOV     R16, R24
   \   00000024   ....               RCALL   hart_gpio_hart_carrier_on_irq
    377              OS_DecRI();
   \   00000026   9100....           LDS     R16, (OS_Global + 1)
   \   0000002A   7F00               ANDI    R16, 0xF0
   \   0000002C   2300               TST     R16
   \   0000002E   F021               BREQ    ??hart_gpio_hart_carrier_on_1
   \   00000030   E909               LDI     R16, 153
   \   00000032   E010               LDI     R17, 0
   \   00000034   ........           CALL    OS_Error
   \                     ??hart_gpio_hart_carrier_on_1:
   \   00000038   9100....           LDS     R16, (OS_Global + 1)
   \   0000003C   950A               DEC     R16
   \   0000003E   9300....           STS     (OS_Global + 1), R16
   \   00000042   9100....           LDS     R16, (OS_Global + 1)
   \   00000046   2300               TST     R16
   \   00000048   F409               BRNE    ??hart_gpio_hart_carrier_on_2
   \   0000004A   9478               sei
    378          }
   \                     ??hart_gpio_hart_carrier_on_2:
   \   0000004C   9189               LD      R24, Y+
   \   0000004E   9508               RET
    379          

   \                                 In  segment CODE, align 2, keep-with-next
    380          void hart_gpio_hart_carrier_on_irq(hart_modem_t modem) {
   \                     hart_gpio_hart_carrier_on_irq:
    381              switch ( modem ) {
   \   00000000   2F10               MOV     R17, R16
   \   00000002   5010               SUBI    R17, 0
   \   00000004   F029               BREQ    ??hart_gpio_hart_carrier_on_irq_0
   \   00000006   951A               DEC     R17
   \   00000008   F041               BREQ    ??hart_gpio_hart_carrier_on_irq_1
   \   0000000A   951A               DEC     R17
   \   0000000C   F061               BREQ    ??hart_gpio_hart_carrier_on_irq_2
   \   0000000E   9508               RET
    382              case hart_modem_0:
    383                  {
    384                      uint8_t tmpReg = PORTD;
   \                     ??hart_gpio_hart_carrier_on_irq_0:
   \   00000010   B11B               IN      R17, 0x0B
    385                      tmpReg &= ~__BIT_MASK(4);
   \   00000012   7E1F               ANDI    R17, 0xEF
    386                      PORTD = tmpReg;
   \   00000014   B91B               OUT     0x0B, R17
    387                  }
    388                  PORTD &= ~__BIT_MASK(4);
   \   00000016   985C               CBI     0x0B, 0x04
    389                  break;
   \   00000018   9508               RET
    390              case hart_modem_1:
    391                  {
    392                      uint8_t tmpReg = PORTH;
   \                     ??hart_gpio_hart_carrier_on_irq_1:
   \   0000001A   9110....           LDS     R17, _A_PORTH
    393                      tmpReg &= ~__BIT_MASK(2);
   \   0000001E   7F1B               ANDI    R17, 0xFB
    394                      PORTH = tmpReg;
   \   00000020   9310....           STS     _A_PORTH, R17
    395                  }
    396                  break;
   \   00000024   9508               RET
    397              case hart_modem_2:
    398                  {
    399                      uint8_t tmpReg = PORTJ;
   \                     ??hart_gpio_hart_carrier_on_irq_2:
   \   00000026   9110....           LDS     R17, _A_PORTJ
    400                      tmpReg &= ~__BIT_MASK(2);
   \   0000002A   7F1B               ANDI    R17, 0xFB
    401                      PORTJ = tmpReg;
   \   0000002C   9310....           STS     _A_PORTJ, R17
    402                  }
    403                  break;
    404              }
    405          }
   \   00000030   9508               RET
   \   00000032                      REQUIRE _A_PORTD
   \   00000032                      REQUIRE _A_PORTH
   \   00000032                      REQUIRE _A_PORTJ
    406          
    407          ////////////////////////////////////////////////////////////////////////////////
    408          //
    409          // Misc
    410          //
    411          ////////////////////////////////////////////////////////////////////////////////
    412          /*
    413           *
    414           * Debug LED: PG5
    415           * 
    416           * Address Rotary Switch 0 : PE4
    417           * Address Rotary Switch 1 : PE5
    418           * Address Rotary Switch 2 : PE6
    419           * Address Rotary Switch 3 : PE7 
    420           *
    421           * My485UART0 RS485 RX/TX Control : PE2
    422           *
    423           * ADC CLOCK, OSC, 1 MHz : PE3
    424           */

   \                                 In  segment CODE, align 2, keep-with-next
    425          static void hart_gpio_misc_gpio_init(void) {
   \                     hart_gpio_misc_gpio_init:
    426          
    427              My_SetBit(DDRG, __BIT_MASK(5));        // Debug LED: PG5 as output
   \   00000000   9100....           LDS     R16, (OS_Global + 1)
   \   00000004   7F00               ANDI    R16, 0xF0
   \   00000006   2300               TST     R16
   \   00000008   F021               BREQ    ??hart_gpio_misc_gpio_init_0
   \   0000000A   E909               LDI     R16, 153
   \   0000000C   E010               LDI     R17, 0
   \   0000000E   ........           CALL    OS_Error
   \                     ??hart_gpio_misc_gpio_init_0:
   \   00000012   94F8               cli
   \   00000014   9100....           LDS     R16, (OS_Global + 1)
   \   00000018   9503               INC     R16
   \   0000001A   9300....           STS     (OS_Global + 1), R16
   \   0000001E   9A9D               SBI     0x13, 0x05
   \   00000020   9100....           LDS     R16, (OS_Global + 1)
   \   00000024   7F00               ANDI    R16, 0xF0
   \   00000026   2300               TST     R16
   \   00000028   F021               BREQ    ??hart_gpio_misc_gpio_init_1
   \   0000002A   E909               LDI     R16, 153
   \   0000002C   E010               LDI     R17, 0
   \   0000002E   ........           CALL    OS_Error
   \                     ??hart_gpio_misc_gpio_init_1:
   \   00000032   9100....           LDS     R16, (OS_Global + 1)
   \   00000036   950A               DEC     R16
   \   00000038   9300....           STS     (OS_Global + 1), R16
   \   0000003C   9100....           LDS     R16, (OS_Global + 1)
   \   00000040   2300               TST     R16
   \   00000042   F409               BRNE    ??hart_gpio_misc_gpio_init_2
   \   00000044   9478               sei
    428          
    429          
    430              My_ClrBit(DDRE, (0xf0));               // PE4-PE7 as input
   \                     ??hart_gpio_misc_gpio_init_2:
   \   00000046   9100....           LDS     R16, (OS_Global + 1)
   \   0000004A   7F00               ANDI    R16, 0xF0
   \   0000004C   2300               TST     R16
   \   0000004E   F021               BREQ    ??hart_gpio_misc_gpio_init_3
   \   00000050   E909               LDI     R16, 153
   \   00000052   E010               LDI     R17, 0
   \   00000054   ........           CALL    OS_Error
   \                     ??hart_gpio_misc_gpio_init_3:
   \   00000058   94F8               cli
   \   0000005A   9100....           LDS     R16, (OS_Global + 1)
   \   0000005E   9503               INC     R16
   \   00000060   9300....           STS     (OS_Global + 1), R16
   \   00000064   B10D               IN      R16, 0x0D
   \   00000066   700F               ANDI    R16, 0x0F
   \   00000068   B90D               OUT     0x0D, R16
   \   0000006A   9100....           LDS     R16, (OS_Global + 1)
   \   0000006E   7F00               ANDI    R16, 0xF0
   \   00000070   2300               TST     R16
   \   00000072   F021               BREQ    ??hart_gpio_misc_gpio_init_4
   \   00000074   E909               LDI     R16, 153
   \   00000076   E010               LDI     R17, 0
   \   00000078   ........           CALL    OS_Error
   \                     ??hart_gpio_misc_gpio_init_4:
   \   0000007C   9100....           LDS     R16, (OS_Global + 1)
   \   00000080   950A               DEC     R16
   \   00000082   9300....           STS     (OS_Global + 1), R16
   \   00000086   9100....           LDS     R16, (OS_Global + 1)
   \   0000008A   2300               TST     R16
   \   0000008C   F409               BRNE    ??hart_gpio_misc_gpio_init_5
   \   0000008E   9478               sei
    431          
    432              My_SetBit(DDRE,  __BIT_MASK(2));       // PE2 : My485UART0 RS485 RX/TX Control
   \                     ??hart_gpio_misc_gpio_init_5:
   \   00000090   9100....           LDS     R16, (OS_Global + 1)
   \   00000094   7F00               ANDI    R16, 0xF0
   \   00000096   2300               TST     R16
   \   00000098   F021               BREQ    ??hart_gpio_misc_gpio_init_6
   \   0000009A   E909               LDI     R16, 153
   \   0000009C   E010               LDI     R17, 0
   \   0000009E   ........           CALL    OS_Error
   \                     ??hart_gpio_misc_gpio_init_6:
   \   000000A2   94F8               cli
   \   000000A4   9100....           LDS     R16, (OS_Global + 1)
   \   000000A8   9503               INC     R16
   \   000000AA   9300....           STS     (OS_Global + 1), R16
   \   000000AE   9A6A               SBI     0x0D, 0x02
   \   000000B0   9100....           LDS     R16, (OS_Global + 1)
   \   000000B4   7F00               ANDI    R16, 0xF0
   \   000000B6   2300               TST     R16
   \   000000B8   F021               BREQ    ??hart_gpio_misc_gpio_init_7
   \   000000BA   E909               LDI     R16, 153
   \   000000BC   E010               LDI     R17, 0
   \   000000BE   ........           CALL    OS_Error
   \                     ??hart_gpio_misc_gpio_init_7:
   \   000000C2   9100....           LDS     R16, (OS_Global + 1)
   \   000000C6   950A               DEC     R16
   \   000000C8   9300....           STS     (OS_Global + 1), R16
   \   000000CC   9100....           LDS     R16, (OS_Global + 1)
   \   000000D0   2300               TST     R16
   \   000000D2   F409               BRNE    ??hart_gpio_misc_gpio_init_8
   \   000000D4   9478               sei
    433              My_ClrBit(PORTE, __BIT_MASK(2));
   \                     ??hart_gpio_misc_gpio_init_8:
   \   000000D6   9100....           LDS     R16, (OS_Global + 1)
   \   000000DA   7F00               ANDI    R16, 0xF0
   \   000000DC   2300               TST     R16
   \   000000DE   F021               BREQ    ??hart_gpio_misc_gpio_init_9
   \   000000E0   E909               LDI     R16, 153
   \   000000E2   E010               LDI     R17, 0
   \   000000E4   ........           CALL    OS_Error
   \                     ??hart_gpio_misc_gpio_init_9:
   \   000000E8   94F8               cli
   \   000000EA   9100....           LDS     R16, (OS_Global + 1)
   \   000000EE   9503               INC     R16
   \   000000F0   9300....           STS     (OS_Global + 1), R16
   \   000000F4   9872               CBI     0x0E, 0x02
   \   000000F6   9100....           LDS     R16, (OS_Global + 1)
   \   000000FA   7F00               ANDI    R16, 0xF0
   \   000000FC   2300               TST     R16
   \   000000FE   F021               BREQ    ??hart_gpio_misc_gpio_init_10
   \   00000100   E909               LDI     R16, 153
   \   00000102   E010               LDI     R17, 0
   \   00000104   ........           CALL    OS_Error
   \                     ??hart_gpio_misc_gpio_init_10:
   \   00000108   9100....           LDS     R16, (OS_Global + 1)
   \   0000010C   950A               DEC     R16
   \   0000010E   9300....           STS     (OS_Global + 1), R16
   \   00000112   9100....           LDS     R16, (OS_Global + 1)
   \   00000116   2300               TST     R16
   \   00000118   F409               BRNE    ??hart_gpio_misc_gpio_init_11
   \   0000011A   9478               sei
    434          
    435              My_SetBit(DDRE, __BIT_MASK(3));        // PE3 : 1 MHz ADC Clock
   \                     ??hart_gpio_misc_gpio_init_11:
   \   0000011C   9100....           LDS     R16, (OS_Global + 1)
   \   00000120   7F00               ANDI    R16, 0xF0
   \   00000122   2300               TST     R16
   \   00000124   F021               BREQ    ??hart_gpio_misc_gpio_init_12
   \   00000126   E909               LDI     R16, 153
   \   00000128   E010               LDI     R17, 0
   \   0000012A   ........           CALL    OS_Error
   \                     ??hart_gpio_misc_gpio_init_12:
   \   0000012E   94F8               cli
   \   00000130   9100....           LDS     R16, (OS_Global + 1)
   \   00000134   9503               INC     R16
   \   00000136   9300....           STS     (OS_Global + 1), R16
   \   0000013A   9A6B               SBI     0x0D, 0x03
   \   0000013C   9100....           LDS     R16, (OS_Global + 1)
   \   00000140   7F00               ANDI    R16, 0xF0
   \   00000142   2300               TST     R16
   \   00000144   F021               BREQ    ??hart_gpio_misc_gpio_init_13
   \   00000146   E909               LDI     R16, 153
   \   00000148   E010               LDI     R17, 0
   \   0000014A   ........           CALL    OS_Error
   \                     ??hart_gpio_misc_gpio_init_13:
   \   0000014E   9100....           LDS     R16, (OS_Global + 1)
   \   00000152   950A               DEC     R16
   \   00000154   9300....           STS     (OS_Global + 1), R16
   \   00000158   9100....           LDS     R16, (OS_Global + 1)
   \   0000015C   2300               TST     R16
   \   0000015E   F409               BRNE    ??hart_gpio_misc_gpio_init_14
   \   00000160   9478               sei
    436          }
   \                     ??hart_gpio_misc_gpio_init_14:
   \   00000162   9508               RET
   \   00000164                      REQUIRE _A_DDRG
   \   00000164                      REQUIRE _A_DDRE
   \   00000164                      REQUIRE _A_PORTE
    437          

   \                                 In  segment CODE, align 2, keep-with-next
    438          void hart_gpio_debug_led(uint8_t on) {
   \                     hart_gpio_debug_led:
    439              // No protection needed as exclusive use
    440              //OS_EnterRegion();
    441              //OS_IncDI();
    442              if ( on ) {
   \   00000000   2300               TST     R16
   \   00000002   F011               BREQ    ??hart_gpio_debug_led_0
    443                  PORTG &= ~__BIT_MASK(5);
   \   00000004   98A5               CBI     0x14, 0x05
   \   00000006   9508               RET
    444              } else {
    445                  PORTG |=  __BIT_MASK(5);
   \                     ??hart_gpio_debug_led_0:
   \   00000008   9AA5               SBI     0x14, 0x05
    446              }
    447              //OS_LeaveRegion();
    448              //OS_DecRI();
    449          }
   \   0000000A   9508               RET
   \   0000000C                      REQUIRE _A_PORTG
    450          
    451          ////////////////////////////////////////////////////////////////////////////////
    452          //
    453          // GPIO init
    454          //
    455          ////////////////////////////////////////////////////////////////////////////////

   \                                 In  segment CODE, align 2, keep-with-next
    456          void
    457          hart_gpio_init(void) {
   \                     hart_gpio_init:
    458              hart_gpio_power_gpio_init();
   \   00000000   ....               RCALL   hart_gpio_power_gpio_init
    459              hart_gpio_mux_gpio_init();
   \   00000002   ....               RCALL   hart_gpio_mux_gpio_init
    460              hart_gpio_adc_gpio_init();
   \   00000004   ....               RCALL   hart_gpio_adc_gpio_init
    461              hart_gpio_modem_gpio_init();
   \   00000006   ....               RCALL   hart_gpio_modem_gpio_init
    462              hart_gpio_misc_gpio_init();
   \   00000008   ....               RCALL   hart_gpio_misc_gpio_init
    463          }
   \   0000000A   9508               RET

   Maximum stack usage in bytes:

   CSTACK RSTACK Function
   ------ ------ --------
      0      2   hart_gpio_adc_channel_select
      0      2   hart_gpio_adc_gpio_init
        0      2   -> OS_Error
        0      2   -> hart_gpio_adc_reset
      1      2   hart_gpio_adc_reset
        1      2   -> OS_Error
      3      2   hart_gpio_channel_select
        3      2   -> OS_Error
      0      2   hart_gpio_debug_led
      0      2   hart_gpio_enable_all_mux
        0      2   -> hart_gpio_mux_enable
      1      2   hart_gpio_hart_carrier_off
        1      2   -> OS_Error
        1      2   -> hart_gpio_hart_carrier_off_irq
      0      2   hart_gpio_hart_carrier_off_irq
      1      2   hart_gpio_hart_carrier_on
        1      2   -> OS_Error
        1      2   -> hart_gpio_hart_carrier_on_irq
      0      2   hart_gpio_hart_carrier_on_irq
      0      2   hart_gpio_init
        0      2   -> hart_gpio_adc_gpio_init
        0      2   -> hart_gpio_misc_gpio_init
        0      2   -> hart_gpio_modem_gpio_init
        0      2   -> hart_gpio_mux_gpio_init
        0      2   -> hart_gpio_power_gpio_init
      0      2   hart_gpio_misc_gpio_init
        0      2   -> OS_Error
      0      2   hart_gpio_modem_gpio_init
        0      2   -> OS_Error
        0      2   -> hart_gpio_hart_carrier_off
      1      2   hart_gpio_mux_disable
        1      2   -> OS_Error
      1      2   hart_gpio_mux_enable
        1      2   -> OS_Error
      0      2   hart_gpio_mux_gpio_init
        0      2   -> OS_Error
      0      2   hart_gpio_power_gpio_init
        0      2   -> OS_Error
      1      2   hart_gpio_power_off
        1      2   -> OS_Error
        1      2 ?S_SHL_L02
      1      2   hart_gpio_power_on
        1      2   -> OS_Error
        1      2 ?S_SHL_L02


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
       1  _A_DDRA
       1  _A_DDRC
       1  _A_DDRD
       1  _A_DDRE
       1  _A_DDRF
       1  _A_DDRG
       1  _A_DDRH
       1  _A_DDRJ
       1  _A_DDRK
       1  _A_DDRL
       1  _A_PORTA
       1  _A_PORTC
       1  _A_PORTD
       1  _A_PORTE
       1  _A_PORTF
       1  _A_PORTG
       1  _A_PORTH
       1  _A_PORTJ
       1  _A_PORTK
       1  _A_PORTL
      10  hart_gpio_adc_channel_select
     540  hart_gpio_adc_gpio_init
     170  hart_gpio_adc_reset
     296  hart_gpio_channel_select
      12  hart_gpio_debug_led
      14  hart_gpio_enable_all_mux
      80  hart_gpio_hart_carrier_off
      48  hart_gpio_hart_carrier_off_irq
      80  hart_gpio_hart_carrier_on
      50  hart_gpio_hart_carrier_on_irq
      12  hart_gpio_init
     356  hart_gpio_misc_gpio_init
     240  hart_gpio_modem_gpio_init
     256  hart_gpio_mux_disable
     256  hart_gpio_mux_enable
     680  hart_gpio_mux_gpio_init
     306  hart_gpio_power_gpio_init
     206  hart_gpio_power_off
     202  hart_gpio_power_on

 
    20 bytes in segment ABSOLUTE
 3 814 bytes in segment CODE
 
 3 814 bytes of CODE memory
     0 bytes of DATA memory (+ 20 bytes shared)

Errors: none
Warnings: none
