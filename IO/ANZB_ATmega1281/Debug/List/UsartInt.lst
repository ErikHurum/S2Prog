###############################################################################
#
# IAR C/C++ Compiler V7.30.5.1680 for Microchip AVR       15/Feb/2024  16:44:03
# Copyright 1996-2022 IAR Systems AB.
# Mobile license - IAR Embedded Workbench for Microchip AVR 8.10
#
#    Source file  =  
#        C:\Users\ESY\OneDrive -
#        Scanjet\Documents\GitHub\S2Prog\IO\ANZB_ATmega1281\Src\UsartInt.c
#    Command line =  
#        -f C:\Users\ESY\AppData\Local\Temp\EW4B5F.tmp ("C:\Users\ESY\OneDrive
#        - Scanjet\Documents\GitHub\S2Prog\IO\ANZB_ATmega1281\Src\UsartInt.c"
#        --cpu=m1281 -ms -o "C:\Users\ESY\OneDrive -
#        Scanjet\Documents\GitHub\S2Prog\IO\ANZB_ATmega1281\Debug\Obj" -D
#        OS_LIBMODE_D -D OS_UART=-1 -D USE_16552_DRIVER_TASK=1 -D
#        USE_1281_RX_INT_TASK=1 -D USE_MODBUS_PROTOCOL=0 -D ANZBANA_V8=1 -D
#        __ATMEGA_1281__ -lCN "C:\Users\ESY\OneDrive -
#        Scanjet\Documents\GitHub\S2Prog\IO\ANZB_ATmega1281\Debug\List" -y
#        --no_cse --no_inline --no_code_motion --no_cross_call --no_clustering
#        --no_tbaa --debug -DENABLE_BIT_DEFINITIONS -e -I
#        "C:\Users\ESY\OneDrive -
#        Scanjet\Documents\GitHub\S2Prog\IO\ANZB_ATmega1281\INC\\" -I
#        "C:\Users\ESY\OneDrive -
#        Scanjet\Documents\GitHub\S2Prog\IO\ANZB_ATmega1281\..\..\SHARED\INC\\"
#        --eeprom_size 4096 --clib -On)
#    Locale       =  English_USA.1252
#    List file    =  
#        C:\Users\ESY\OneDrive -
#        Scanjet\Documents\GitHub\S2Prog\IO\ANZB_ATmega1281\Debug\List\UsartInt.lst
#    Object file  =  
#        C:\Users\ESY\OneDrive -
#        Scanjet\Documents\GitHub\S2Prog\IO\ANZB_ATmega1281\Debug\Obj\UsartInt.r90
#
###############################################################################

C:\Users\ESY\OneDrive - Scanjet\Documents\GitHub\S2Prog\IO\ANZB_ATmega1281\Src\UsartInt.c
      1          /****************************************************************************************
      2          / USART1 functions and interrupt
      3          /   This routines sync and check the ANPRO10
      4          /   Uart1Pro.c handle the package
      5          /
      6          ***************************************************************************************/
      7          #if USE_MODBUS_PROTOCOL == 0
      8          
      9              #include "iom1281.h"

   \                                 In  segment ABSOLUTE, at 0xce
   \   union <unnamed> volatile __io _A_UDR1
   \                     _A_UDR1:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0xc9
   \   union <unnamed> volatile __io _A_UCSR1B
   \                     _A_UCSR1B:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0xc8
   \   union <unnamed> volatile __io _A_UCSR1A
   \                     _A_UCSR1A:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0xc6
   \   union <unnamed> volatile __io _A_UDR0
   \                     _A_UDR0:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0xc1
   \   union <unnamed> volatile __io _A_UCSR0B
   \                     _A_UCSR0B:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0xc0
   \   union <unnamed> volatile __io _A_UCSR0A
   \                     _A_UCSR0A:
   \   00000000                      DS8 1

   \                                 In  segment ABSOLUTE, at 0x2e
   \   union <unnamed> volatile __io _A_PORTE
   \                     _A_PORTE:
   \   00000000                      DS8 1
     10              #include "stdio.h"
     11              #include "math.h"
     12              #include "externals.h"
     13              #include "version.h"
     14              #pragma diag_suppress=Pa082
     15          
     16          
     17          
     18              #if USE_1281_RX_INT_TASK==1

   \                                 In  segment CODE, align 2, keep-with-next
     19          static void _ATMega1281_irq_handler(char Ch) {
   \                     _ATMega1281_irq_handler:
   \   00000000   ........           CALL    ?PROLOGUE4_L09
   \   00000004   9721               SBIW    R29:R28, 1
   \   00000006   2F80               MOV     R24, R16
     20              char RxByte;
     21              OS_GetMail1(&UART[Ch].RxMailBox, &RxByte);
   \   00000008   019E               MOVW    R19:R18, R29:R28
   \   0000000A   ....               LDI     R16, LOW((UART + 498))
   \   0000000C   ....               LDI     R17, HIGH((UART + 498))
   \   0000000E   2F48               MOV     R20, R24
   \   00000010   E050               LDI     R21, 0
   \   00000012   2F54               MOV     R21, R20
   \   00000014   E040               LDI     R20, 0
   \   00000016   0F55               LSL     R21
   \   00000018   0F04               ADD     R16, R20
   \   0000001A   1F15               ADC     R17, R21
   \   0000001C   ........           CALL    OS_GetMail1
     22          
     23              UART[Ch].pRxBuffer[UART[Ch].RxFirst] = RxByte;    // Read the character
   \   00000020   8148               LD      R20, Y
   \   00000022   ....               LDI     R16, LOW((UART + 283))
   \   00000024   ....               LDI     R17, HIGH((UART + 283))
   \   00000026   2F28               MOV     R18, R24
   \   00000028   E030               LDI     R19, 0
   \   0000002A   2F32               MOV     R19, R18
   \   0000002C   E020               LDI     R18, 0
   \   0000002E   0F33               LSL     R19
   \   00000030   01F9               MOVW    R31:R30, R19:R18
   \   00000032   ....               SUBI    R30, LOW((-(UART + 433) & 0xFFFF))
   \   00000034   ....               SBCI    R31, HIGH((-(UART + 433) & 0xFFFF))
   \   00000036   8120               LD      R18, Z
   \   00000038   8131               LDD     R19, Z+1
   \   0000003A   0F02               ADD     R16, R18
   \   0000003C   1F13               ADC     R17, R19
   \   0000003E   2F28               MOV     R18, R24
   \   00000040   E030               LDI     R19, 0
   \   00000042   2F32               MOV     R19, R18
   \   00000044   E020               LDI     R18, 0
   \   00000046   0F33               LSL     R19
   \   00000048   0F02               ADD     R16, R18
   \   0000004A   1F13               ADC     R17, R19
   \   0000004C   01F8               MOVW    R31:R30, R17:R16
   \   0000004E   8340               ST      Z, R20
     24              switch (UART[Ch].RxState) {
   \   00000050   2F08               MOV     R16, R24
   \   00000052   E010               LDI     R17, 0
   \   00000054   2F10               MOV     R17, R16
   \   00000056   E000               LDI     R16, 0
   \   00000058   0F11               LSL     R17
   \   0000005A   01F8               MOVW    R31:R30, R17:R16
   \   0000005C   ....               SUBI    R30, LOW((-(UART + 439) & 0xFFFF))
   \   0000005E   ....               SBCI    R31, HIGH((-(UART + 439) & 0xFFFF))
   \   00000060   8100               LD      R16, Z
   \   00000062   5000               SUBI    R16, 0
   \   00000064   F021               BREQ    ??_ATMega1281_irq_handler_0
   \   00000066   500A               SUBI    R16, 10
   \   00000068   F009               BREQ    $+2+2
   \   0000006A   C08F               RJMP    ??_ATMega1281_irq_handler_1
     25              case HANDLE:
     26                  // Not OK to receive as we are handling the message
     27                  break;
   \   0000006C   C0AE               RJMP    ??_ATMega1281_irq_handler_2
     28              case SYNC :
     29                  if (UART[Ch].pRxBuffer[UART[Ch].RxFirst] == ANPRO10_SYN) {
   \                     ??_ATMega1281_irq_handler_0:
   \   0000006E   ....               LDI     R16, LOW((UART + 283))
   \   00000070   ....               LDI     R17, HIGH((UART + 283))
   \   00000072   2F28               MOV     R18, R24
   \   00000074   E030               LDI     R19, 0
   \   00000076   2F32               MOV     R19, R18
   \   00000078   E020               LDI     R18, 0
   \   0000007A   0F33               LSL     R19
   \   0000007C   01F9               MOVW    R31:R30, R19:R18
   \   0000007E   ....               SUBI    R30, LOW((-(UART + 433) & 0xFFFF))
   \   00000080   ....               SBCI    R31, HIGH((-(UART + 433) & 0xFFFF))
   \   00000082   8120               LD      R18, Z
   \   00000084   8131               LDD     R19, Z+1
   \   00000086   0F02               ADD     R16, R18
   \   00000088   1F13               ADC     R17, R19
   \   0000008A   2F28               MOV     R18, R24
   \   0000008C   E030               LDI     R19, 0
   \   0000008E   2F32               MOV     R19, R18
   \   00000090   E020               LDI     R18, 0
   \   00000092   0F33               LSL     R19
   \   00000094   0F02               ADD     R16, R18
   \   00000096   1F13               ADC     R17, R19
   \   00000098   01F8               MOVW    R31:R30, R17:R16
   \   0000009A   8100               LD      R16, Z
   \   0000009C   3106               CPI     R16, 22
   \   0000009E   F4C1               BRNE    ??_ATMega1281_irq_handler_3
     30                      UART[Ch].SyncCnt++;                 // count sync
   \   000000A0   2F08               MOV     R16, R24
   \   000000A2   E010               LDI     R17, 0
   \   000000A4   2F10               MOV     R17, R16
   \   000000A6   E000               LDI     R16, 0
   \   000000A8   0F11               LSL     R17
   \   000000AA   01F8               MOVW    R31:R30, R17:R16
   \   000000AC   ....               SUBI    R30, LOW((-(UART + 440) & 0xFFFF))
   \   000000AE   ....               SBCI    R31, HIGH((-(UART + 440) & 0xFFFF))
   \   000000B0   8100               LD      R16, Z
   \   000000B2   9503               INC     R16
   \   000000B4   8300               ST      Z, R16
     31                      UART[Ch].RxFirst = 0;                 // start at start of buff
   \   000000B6   2F08               MOV     R16, R24
   \   000000B8   E010               LDI     R17, 0
   \   000000BA   2F10               MOV     R17, R16
   \   000000BC   E000               LDI     R16, 0
   \   000000BE   0F11               LSL     R17
   \   000000C0   01F8               MOVW    R31:R30, R17:R16
   \   000000C2   ....               SUBI    R30, LOW((-(UART + 433) & 0xFFFF))
   \   000000C4   ....               SBCI    R31, HIGH((-(UART + 433) & 0xFFFF))
   \   000000C6   E000               LDI     R16, 0
   \   000000C8   E010               LDI     R17, 0
   \   000000CA   8300               ST      Z, R16
   \   000000CC   8311               STD     Z+1, R17
   \   000000CE   C07D               RJMP    ??_ATMega1281_irq_handler_2
     32                  } else if ((UART[Ch].SyncCnt >= 2) &&
     33                             (UART[Ch].pRxBuffer[UART[Ch].RxFirst] == ANPRO10_SOH)) {       // minimum two sync bytes
   \                     ??_ATMega1281_irq_handler_3:
   \   000000D0   2F08               MOV     R16, R24
   \   000000D2   E010               LDI     R17, 0
   \   000000D4   2F10               MOV     R17, R16
   \   000000D6   E000               LDI     R16, 0
   \   000000D8   0F11               LSL     R17
   \   000000DA   01F8               MOVW    R31:R30, R17:R16
   \   000000DC   ....               SUBI    R30, LOW((-(UART + 440) & 0xFFFF))
   \   000000DE   ....               SBCI    R31, HIGH((-(UART + 440) & 0xFFFF))
   \   000000E0   8100               LD      R16, Z
   \   000000E2   3002               CPI     R16, 2
   \   000000E4   F408               BRCC    $+2+2
   \   000000E6   C046               RJMP    ??_ATMega1281_irq_handler_4
   \   000000E8   ....               LDI     R16, LOW((UART + 283))
   \   000000EA   ....               LDI     R17, HIGH((UART + 283))
   \   000000EC   2F28               MOV     R18, R24
   \   000000EE   E030               LDI     R19, 0
   \   000000F0   2F32               MOV     R19, R18
   \   000000F2   E020               LDI     R18, 0
   \   000000F4   0F33               LSL     R19
   \   000000F6   01F9               MOVW    R31:R30, R19:R18
   \   000000F8   ....               SUBI    R30, LOW((-(UART + 433) & 0xFFFF))
   \   000000FA   ....               SBCI    R31, HIGH((-(UART + 433) & 0xFFFF))
   \   000000FC   8120               LD      R18, Z
   \   000000FE   8131               LDD     R19, Z+1
   \   00000100   0F02               ADD     R16, R18
   \   00000102   1F13               ADC     R17, R19
   \   00000104   2F28               MOV     R18, R24
   \   00000106   E030               LDI     R19, 0
   \   00000108   2F32               MOV     R19, R18
   \   0000010A   E020               LDI     R18, 0
   \   0000010C   0F33               LSL     R19
   \   0000010E   0F02               ADD     R16, R18
   \   00000110   1F13               ADC     R17, R19
   \   00000112   01F8               MOVW    R31:R30, R17:R16
   \   00000114   8100               LD      R16, Z
   \   00000116   3001               CPI     R16, 1
   \   00000118   F569               BRNE    ??_ATMega1281_irq_handler_4
     34                      UART[Ch].SyncCnt = 0;                // reset counter
   \   0000011A   2F08               MOV     R16, R24
   \   0000011C   E010               LDI     R17, 0
   \   0000011E   2F10               MOV     R17, R16
   \   00000120   E000               LDI     R16, 0
   \   00000122   0F11               LSL     R17
   \   00000124   01F8               MOVW    R31:R30, R17:R16
   \   00000126   ....               SUBI    R30, LOW((-(UART + 440) & 0xFFFF))
   \   00000128   ....               SBCI    R31, HIGH((-(UART + 440) & 0xFFFF))
   \   0000012A   E000               LDI     R16, 0
   \   0000012C   8300               ST      Z, R16
     35                      UART[Ch].RxState = HEADER;
   \   0000012E   2F08               MOV     R16, R24
   \   00000130   E010               LDI     R17, 0
   \   00000132   2F10               MOV     R17, R16
   \   00000134   E000               LDI     R16, 0
   \   00000136   0F11               LSL     R17
   \   00000138   01F8               MOVW    R31:R30, R17:R16
   \   0000013A   ....               SUBI    R30, LOW((-(UART + 439) & 0xFFFF))
   \   0000013C   ....               SBCI    R31, HIGH((-(UART + 439) & 0xFFFF))
   \   0000013E   E001               LDI     R16, 1
   \   00000140   8300               ST      Z, R16
     36                      UART[Ch].RxLast = 0;
   \   00000142   2F08               MOV     R16, R24
   \   00000144   E010               LDI     R17, 0
   \   00000146   2F10               MOV     R17, R16
   \   00000148   E000               LDI     R16, 0
   \   0000014A   0F11               LSL     R17
   \   0000014C   01F8               MOVW    R31:R30, R17:R16
   \   0000014E   ....               SUBI    R30, LOW((-(UART + 435) & 0xFFFF))
   \   00000150   ....               SBCI    R31, HIGH((-(UART + 435) & 0xFFFF))
   \   00000152   E000               LDI     R16, 0
   \   00000154   E010               LDI     R17, 0
   \   00000156   8300               ST      Z, R16
   \   00000158   8311               STD     Z+1, R17
     37                      UART[Ch].RxTimeout = RX_TO_TIME;    // reset timeout
   \   0000015A   2F08               MOV     R16, R24
   \   0000015C   E010               LDI     R17, 0
   \   0000015E   2F10               MOV     R17, R16
   \   00000160   E000               LDI     R16, 0
   \   00000162   0F11               LSL     R17
   \   00000164   01F8               MOVW    R31:R30, R17:R16
   \   00000166   ....               SUBI    R30, LOW((-(UART + 441) & 0xFFFF))
   \   00000168   ....               SBCI    R31, HIGH((-(UART + 441) & 0xFFFF))
   \   0000016A   EF0A               LDI     R16, 250
   \   0000016C   E010               LDI     R17, 0
   \   0000016E   8300               ST      Z, R16
   \   00000170   8311               STD     Z+1, R17
   \   00000172   C02B               RJMP    ??_ATMega1281_irq_handler_2
     38                  } else {
     39                      UART[Ch].SyncCnt = 0;                // start over once more
   \                     ??_ATMega1281_irq_handler_4:
   \   00000174   2F08               MOV     R16, R24
   \   00000176   E010               LDI     R17, 0
   \   00000178   2F10               MOV     R17, R16
   \   0000017A   E000               LDI     R16, 0
   \   0000017C   0F11               LSL     R17
   \   0000017E   01F8               MOVW    R31:R30, R17:R16
   \   00000180   ....               SUBI    R30, LOW((-(UART + 440) & 0xFFFF))
   \   00000182   ....               SBCI    R31, HIGH((-(UART + 440) & 0xFFFF))
   \   00000184   E000               LDI     R16, 0
   \   00000186   8300               ST      Z, R16
     40                  }
     41                  break;
   \   00000188   C020               RJMP    ??_ATMega1281_irq_handler_2
     42              default :
     43                  if ((++UART[Ch].RxFirst) > RXSIZE_UART) { // Point to next location
   \                     ??_ATMega1281_irq_handler_1:
   \   0000018A   2F08               MOV     R16, R24
   \   0000018C   E010               LDI     R17, 0
   \   0000018E   2F10               MOV     R17, R16
   \   00000190   E000               LDI     R16, 0
   \   00000192   0F11               LSL     R17
   \   00000194   01F8               MOVW    R31:R30, R17:R16
   \   00000196   ....               SUBI    R30, LOW((-(UART + 433) & 0xFFFF))
   \   00000198   ....               SBCI    R31, HIGH((-(UART + 433) & 0xFFFF))
   \   0000019A   81A0               LD      R26, Z
   \   0000019C   81B1               LDD     R27, Z+1
   \   0000019E   9611               ADIW    R27:R26, 1
   \   000001A0   2F08               MOV     R16, R24
   \   000001A2   E010               LDI     R17, 0
   \   000001A4   2F10               MOV     R17, R16
   \   000001A6   E000               LDI     R16, 0
   \   000001A8   0F11               LSL     R17
   \   000001AA   01F8               MOVW    R31:R30, R17:R16
   \   000001AC   ....               SUBI    R30, LOW((-(UART + 433) & 0xFFFF))
   \   000001AE   ....               SBCI    R31, HIGH((-(UART + 433) & 0xFFFF))
   \   000001B0   83A0               ST      Z, R26
   \   000001B2   83B1               STD     Z+1, R27
   \   000001B4   39A7               CPI     R26, 151
   \   000001B6   E000               LDI     R16, 0
   \   000001B8   07B0               CPC     R27, R16
   \   000001BA   F020               BRCS    ??_ATMega1281_irq_handler_5
     44                      GoToSyncUART(Ch);                       // go to sync mode
   \   000001BC   2F08               MOV     R16, R24
   \   000001BE   ........           CALL    GoToSyncUART
   \   000001C2   C003               RJMP    ??_ATMega1281_irq_handler_2
     45                  } else {
     46                      ReceivePacketUart(Ch);              // Check package
   \                     ??_ATMega1281_irq_handler_5:
   \   000001C4   2F08               MOV     R16, R24
   \   000001C6   ........           CALL    ReceivePacketUart
     47                  }
     48                  break;
     49              }
     50          }
   \                     ??_ATMega1281_irq_handler_2:
   \   000001CA   9621               ADIW    R29:R28, 1
   \   000001CC   E0E4               LDI     R30, 4
   \   000001CE   ........           JMP     ?EPILOGUE_B4_L09
     51          
     52                  #pragma diag_suppress=Pe767
     53          

   \                                 In  segment CODE, align 2, keep-with-next
     54          void ATMega1281_RX_driver_task(void *pVoid) {
   \                     ATMega1281_RX_driver_task:
   \   00000000   ........           CALL    ?PROLOGUE3_L09
   \   00000004   01C8               MOVW    R25:R24, R17:R16
     55              char Ch = (char)pVoid;
   \   00000006   2FA8               MOV     R26, R24
     56              Init_USART(Ch, 38400);              //
   \   00000008   E040               LDI     R20, 0
   \   0000000A   E956               LDI     R21, 150
   \   0000000C   E060               LDI     R22, 0
   \   0000000E   E070               LDI     R23, 0
   \   00000010   2F0A               MOV     R16, R26
   \   00000012   ........           CALL    Init_USART
     57              while (1) {
     58                  _ATMega1281_irq_handler(Ch);
   \                     ??ATMega1281_RX_driver_task_0:
   \   00000016   2F0A               MOV     R16, R26
   \   00000018   ....               RCALL   _ATMega1281_irq_handler
   \   0000001A   CFFD               RJMP    ??ATMega1281_RX_driver_task_0
     59              }
     60          }
     61          

   \                                 In  segment NEAR_Z, align 1, keep-with-next
   \   00000000                      REQUIRE `?<Segment init: NEAR_Z>`
     62          OS_TASK TCB_ATMega1281RX_Driver0;
   \                     TCB_ATMega1281RX_Driver0:
   \   00000000                      DS8 33

   \                                 In  segment NEAR_Z, align 1, keep-with-next
   \   00000000                      REQUIRE `?<Segment init: NEAR_Z>`
     63          OS_TASK TCB_ATMega1281RX_Driver1;
   \                     TCB_ATMega1281RX_Driver1:
   \   00000000                      DS8 33

   \                                 In  segment NEAR_Z, align 1, keep-with-next
   \   00000000                      REQUIRE `?<Segment init: NEAR_Z>`
     64          static OS_STACKPTR int stack1[300], stack2[300]; /* Task stacks */
   \                     stack1:
   \   00000000                      DS8 600

   \                                 In  segment NEAR_Z, align 1, keep-with-next
   \   00000000                      REQUIRE `?<Segment init: NEAR_Z>`
   \                     stack2:
   \   00000000                      DS8 600
     65          

   \                                 In  segment CODE, align 2, keep-with-next
     66          void ATMega1281_driver_task_init(void) {
   \                     ATMega1281_driver_task_init:
     67              OS_CREATETASK_EX(&TCB_ATMega1281RX_Driver0, "ATMega1281 RX Driver0", ATMega1281_RX_driver_task, 121, stack1, (void *)0);
   \   00000000   E000               LDI     R16, 0
   \   00000002   E010               LDI     R17, 0
   \   00000004   931A               ST      -Y, R17
   \   00000006   930A               ST      -Y, R16
   \   00000008   E002               LDI     R16, 2
   \   0000000A   E010               LDI     R17, 0
   \   0000000C   931A               ST      -Y, R17
   \   0000000E   930A               ST      -Y, R16
   \   00000010   E508               LDI     R16, 88
   \   00000012   E012               LDI     R17, 2
   \   00000014   931A               ST      -Y, R17
   \   00000016   930A               ST      -Y, R16
   \   00000018   ....               LDI     R16, LOW(stack1)
   \   0000001A   ....               LDI     R17, (stack1) >> 8
   \   0000001C   931A               ST      -Y, R17
   \   0000001E   930A               ST      -Y, R16
   \   00000020   ....               LDI     R22, LOW(ATMega1281_RX_driver_task/2)
   \   00000022   ....               LDI     R23, (ATMega1281_RX_driver_task/2) >> 8
   \   00000024   E749               LDI     R20, 121
   \   00000026   ....               LDI     R18, LOW(`?<Constant "ATMega1281 RX Driver0">`)
   \   00000028   ....               LDI     R19, (`?<Constant "ATMega1281 RX Driver0">`) >> 8
   \   0000002A   ....               LDI     R16, LOW(TCB_ATMega1281RX_Driver0)
   \   0000002C   ....               LDI     R17, (TCB_ATMega1281RX_Driver0) >> 8
   \   0000002E   ........           CALL    OS_CreateTaskEx_D
     68              OS_CREATETASK_EX(&TCB_ATMega1281RX_Driver1, "ATMega1281 RX Driver1", ATMega1281_RX_driver_task, 120, stack2, (void *)1);
   \   00000032   E001               LDI     R16, LOW(1)
   \   00000034   E010               LDI     R17, (1) >> 8
   \   00000036   931A               ST      -Y, R17
   \   00000038   930A               ST      -Y, R16
   \   0000003A   E002               LDI     R16, 2
   \   0000003C   E010               LDI     R17, 0
   \   0000003E   931A               ST      -Y, R17
   \   00000040   930A               ST      -Y, R16
   \   00000042   E508               LDI     R16, 88
   \   00000044   E012               LDI     R17, 2
   \   00000046   931A               ST      -Y, R17
   \   00000048   930A               ST      -Y, R16
   \   0000004A   ....               LDI     R16, LOW(stack2)
   \   0000004C   ....               LDI     R17, (stack2) >> 8
   \   0000004E   931A               ST      -Y, R17
   \   00000050   930A               ST      -Y, R16
   \   00000052   ....               LDI     R22, LOW(ATMega1281_RX_driver_task/2)
   \   00000054   ....               LDI     R23, (ATMega1281_RX_driver_task/2) >> 8
   \   00000056   E748               LDI     R20, 120
   \   00000058   ....               LDI     R18, LOW(`?<Constant "ATMega1281 RX Driver1">`)
   \   0000005A   ....               LDI     R19, (`?<Constant "ATMega1281 RX Driver1">`) >> 8
   \   0000005C   ....               LDI     R16, LOW(TCB_ATMega1281RX_Driver1)
   \   0000005E   ....               LDI     R17, (TCB_ATMega1281RX_Driver1) >> 8
   \   00000060   ........           CALL    OS_CreateTaskEx_D
     69          }
   \   00000064   9508               RET
     70              #endif
     71          
     72          
     73          
     74          // USART0

   \                                 In  segment CODE, align 2, keep-with-next
     75          void Int_Handler_RX_USART0(void) {
   \                     Int_Handler_RX_USART0:
     76          
     77              if (UCSR0A & __BIT_MASK(DOR0)) {                // Overrun error?
   \   00000000   9100....           LDS     R16, _A_UCSR0A
     78              }
     79          
     80              if (UCSR0A & __BIT_MASK(FE0)) {                 // Framing error?
   \   00000004   9110....           LDS     R17, _A_UCSR0A
     81              }
     82          #if USE_1281_RX_INT_TASK==0
     83              while (UCSR0A & __BIT_MASK(RXC0)) {                // New byte avaiable?
     84                  UART[0].pRxBuffer[UART[0].RxFirst] = UDR0;    // Read the character
     85          
     86                  if (UART[0].RxState != HANDLE) {                // ok to receive?
     87                      switch (UART[0].RxState) {                   // Yes, check state
     88                      case SYNC :
     89                          if (UART[0].pRxBuffer[UART[0].RxFirst] == ANPRO10_SYN) {
     90                              UART[0].SyncCnt++;                 // count sync
     91                              UART[0].RxFirst = 0;                 // start at start of buff
     92                          } else if ((UART[0].SyncCnt >= 2) &&
     93                                     (UART[0].pRxBuffer[UART[0].RxFirst] == ANPRO10_SOH)) {       // minimum two sync bytes
     94                              UART[0].SyncCnt = 0;                // reset counter
     95                              UART[0].RxState = HEADER;
     96                              UART[0].RxLast = 0;
     97                              UART[0].RxTimeout = RX_TO_TIME;    // reset timeout
     98                          } else {
     99                              UART[0].SyncCnt = 0;                // start over once more
    100                          }
    101                          break;
    102                      default :
    103                          if ((++UART[0].RxFirst) > RXSIZE_UART) { // Point to next location
    104                              GoToSyncUART(0);                       // go to sync mode
    105                          } else {
    106                              ReceivePacketUart(0);              // Check package
    107                          }
    108                          break;
    109                      }
    110                  }
    111              }
    112          #else
    113              while (UCSR0A & __BIT_MASK(RXC0)) {                 // New byte avaiable?
   \                     ??Int_Handler_RX_USART0_0:
   \   00000008   9100....           LDS     R16, _A_UCSR0A
   \   0000000C   2F10               MOV     R17, R16
   \   0000000E   FF17               SBRS    R17, 7
   \   00000010   C00B               RJMP    ??Int_Handler_RX_USART0_1
    114                  UART[0].RxByte = UDR0;                          // Read the character
   \   00000012   9100....           LDS     R16, _A_UDR0
   \   00000016   9300....           STS     (UART + 447), R16
    115                  //if (OS_IsTask(&TCB_ATMega1281RX_Driver0)) {
    116                      OS_PutMailCond1(&UART[0].RxMailBox, &UART[0].RxByte);
   \   0000001A   ....               LDI     R18, LOW((UART + 447))
   \   0000001C   ....               LDI     R19, HIGH((UART + 447))
   \   0000001E   ....               LDI     R16, LOW((UART + 498))
   \   00000020   ....               LDI     R17, HIGH((UART + 498))
   \   00000022   ........           CALL    OS_PutMailCond1
   \   00000026   CFF0               RJMP    ??Int_Handler_RX_USART0_0
    117                  //}
    118              }
    119          #endif
    120          
    121          }
   \                     ??Int_Handler_RX_USART0_1:
   \   00000028   9508               RET
   \   0000002A                      REQUIRE _A_UCSR0A
   \   0000002A                      REQUIRE _A_UDR0
    122          
    123          
    124              #pragma vector=USART0_RX_vect

   \                                 In  segment CODE, align 2, keep-with-next
    125          __interrupt void IntHandler_RX_USART0(void) {
   \                     IntHandler_RX_USART0:
   \   00000000   939A               ST      -Y, R25
   \   00000002   938A               ST      -Y, R24
   \   00000004   93FA               ST      -Y, R31
   \   00000006   93EA               ST      -Y, R30
   \   00000008   923A               ST      -Y, R3
   \   0000000A   922A               ST      -Y, R2
   \   0000000C   921A               ST      -Y, R1
   \   0000000E   920A               ST      -Y, R0
   \   00000010   937A               ST      -Y, R23
   \   00000012   936A               ST      -Y, R22
   \   00000014   935A               ST      -Y, R21
   \   00000016   934A               ST      -Y, R20
   \   00000018   933A               ST      -Y, R19
   \   0000001A   932A               ST      -Y, R18
   \   0000001C   931A               ST      -Y, R17
   \   0000001E   930A               ST      -Y, R16
   \   00000020   B78F               IN      R24, 0x3F
   \   00000022   B79B               IN      R25, 0x3B
    126              OS_CallISR(Int_Handler_RX_USART0);
   \   00000024   ....               LDI     R16, LOW(Int_Handler_RX_USART0/2)
   \   00000026   ....               LDI     R17, (Int_Handler_RX_USART0/2) >> 8
   \   00000028   ........           CALL    OS_CallISR_Debug
    127          }
   \   0000002C   BF9B               OUT     0x3B, R25
   \   0000002E   BF8F               OUT     0x3F, R24
   \   00000030   9109               LD      R16, Y+
   \   00000032   9119               LD      R17, Y+
   \   00000034   9129               LD      R18, Y+
   \   00000036   9139               LD      R19, Y+
   \   00000038   9149               LD      R20, Y+
   \   0000003A   9159               LD      R21, Y+
   \   0000003C   9169               LD      R22, Y+
   \   0000003E   9179               LD      R23, Y+
   \   00000040   9009               LD      R0, Y+
   \   00000042   9019               LD      R1, Y+
   \   00000044   9029               LD      R2, Y+
   \   00000046   9039               LD      R3, Y+
   \   00000048   91E9               LD      R30, Y+
   \   0000004A   91F9               LD      R31, Y+
   \   0000004C   9189               LD      R24, Y+
   \   0000004E   9199               LD      R25, Y+
   \   00000050   9518               RETI
    128          

   \                                 In  segment CODE, align 2, keep-with-next
    129          void Int_Handler_TX_USART0(void) {
   \                     Int_Handler_TX_USART0:
    130          
    131              UCSR0B &= ~(__BIT_MASK(TXCIE0));            // transmission end, disable int.
   \   00000000   910000C1           LDS     R16, 193
   \   00000004   7B0F               ANDI    R16, 0xBF
   \   00000006   930000C1           STS     193, R16
    132              PORTE &= ~0x04;                              // TXE0 off
   \   0000000A   9872               CBI     0x0E, 0x02
    133          #if USE_1281_RX_INT_TASK == 0
    134              OS_StopTimer(&TimerUSART0);                    // and stop timer
    135          #endif
    136              GoToSyncUART(0);                                    // go to sync modus for recive
   \   0000000C   E000               LDI     R16, 0
   \   0000000E   ........           CALL    GoToSyncUART
    137          
    138          }
   \   00000012   9508               RET
   \   00000014                      REQUIRE _A_UCSR0B
   \   00000014                      REQUIRE _A_PORTE
    139          
    140              #pragma vector=USART0_TX_vect

   \                                 In  segment CODE, align 2, keep-with-next
    141          __interrupt void IntHandler_TX_USART0(void) {
   \                     IntHandler_TX_USART0:
   \   00000000   939A               ST      -Y, R25
   \   00000002   938A               ST      -Y, R24
   \   00000004   93FA               ST      -Y, R31
   \   00000006   93EA               ST      -Y, R30
   \   00000008   923A               ST      -Y, R3
   \   0000000A   922A               ST      -Y, R2
   \   0000000C   921A               ST      -Y, R1
   \   0000000E   920A               ST      -Y, R0
   \   00000010   937A               ST      -Y, R23
   \   00000012   936A               ST      -Y, R22
   \   00000014   935A               ST      -Y, R21
   \   00000016   934A               ST      -Y, R20
   \   00000018   933A               ST      -Y, R19
   \   0000001A   932A               ST      -Y, R18
   \   0000001C   931A               ST      -Y, R17
   \   0000001E   930A               ST      -Y, R16
   \   00000020   B78F               IN      R24, 0x3F
   \   00000022   B79B               IN      R25, 0x3B
    142              OS_CallISR(Int_Handler_TX_USART0);
   \   00000024   ....               LDI     R16, LOW(Int_Handler_TX_USART0/2)
   \   00000026   ....               LDI     R17, (Int_Handler_TX_USART0/2) >> 8
   \   00000028   ........           CALL    OS_CallISR_Debug
    143          }
   \   0000002C   BF9B               OUT     0x3B, R25
   \   0000002E   BF8F               OUT     0x3F, R24
   \   00000030   9109               LD      R16, Y+
   \   00000032   9119               LD      R17, Y+
   \   00000034   9129               LD      R18, Y+
   \   00000036   9139               LD      R19, Y+
   \   00000038   9149               LD      R20, Y+
   \   0000003A   9159               LD      R21, Y+
   \   0000003C   9169               LD      R22, Y+
   \   0000003E   9179               LD      R23, Y+
   \   00000040   9009               LD      R0, Y+
   \   00000042   9019               LD      R1, Y+
   \   00000044   9029               LD      R2, Y+
   \   00000046   9039               LD      R3, Y+
   \   00000048   91E9               LD      R30, Y+
   \   0000004A   91F9               LD      R31, Y+
   \   0000004C   9189               LD      R24, Y+
   \   0000004E   9199               LD      R25, Y+
   \   00000050   9518               RETI
    144          

   \                                 In  segment CODE, align 2, keep-with-next
    145          void Int_Handler_UDRE_USART0(void) {
   \                     Int_Handler_UDRE_USART0:
   \   00000000   019C               MOVW    R19:R18, R25:R24
    146              if (UART[0].TxCount-- > 0) {
   \   00000002   ....               LDI     R30, LOW((UART + 279))
   \   00000004   ....               LDI     R31, HIGH((UART + 279))
   \   00000006   8100               LD      R16, Z
   \   00000008   8111               LDD     R17, Z+1
   \   0000000A   01C8               MOVW    R25:R24, R17:R16
   \   0000000C   9701               SBIW    R25:R24, 1
   \   0000000E   ....               LDI     R30, LOW((UART + 279))
   \   00000010   ....               LDI     R31, HIGH((UART + 279))
   \   00000012   8380               ST      Z, R24
   \   00000014   8391               STD     Z+1, R25
   \   00000016   2B01               OR      R16, R17
   \   00000018   F099               BREQ    ??Int_Handler_UDRE_USART0_0
    147                  UDR0 = UART[0].pTxBuffer[UART[0].TxLast];     // Send a character
   \   0000001A   ....               LDI     R30, LOW((UART + 277))
   \   0000001C   ....               LDI     R31, HIGH((UART + 277))
   \   0000001E   8100               LD      R16, Z
   \   00000020   8111               LDD     R17, Z+1
   \   00000022   01F8               MOVW    R31:R30, R17:R16
   \   00000024   ....               SUBI    R30, LOW((-(UART) & 0xFFFF))
   \   00000026   ....               SBCI    R31, (-(UART) & 0xFFFF) >> 8
   \   00000028   8100               LD      R16, Z
   \   0000002A   9300....           STS     _A_UDR0, R16
    148                  UART[0].TxLast++;
   \   0000002E   ....               LDI     R30, LOW((UART + 277))
   \   00000030   ....               LDI     R31, HIGH((UART + 277))
   \   00000032   8100               LD      R16, Z
   \   00000034   8111               LDD     R17, Z+1
   \   00000036   5F0F               SUBI    R16, 255
   \   00000038   4F1F               SBCI    R17, 255
   \   0000003A   8300               ST      Z, R16
   \   0000003C   8311               STD     Z+1, R17
   \   0000003E   C012               RJMP    ??Int_Handler_UDRE_USART0_1
    149              } else {                                             // Last byte sent?
    150                  UCSR0B &= ~(__BIT_MASK(UDRIE0));            // transmission end, disable int.
   \                     ??Int_Handler_UDRE_USART0_0:
   \   00000040   910000C1           LDS     R16, 193
   \   00000044   7D0F               ANDI    R16, 0xDF
   \   00000046   930000C1           STS     193, R16
    151                  UCSR0A |= (__BIT_MASK(TXC0));               // Clear int bit in TXC.
   \   0000004A   910000C0           LDS     R16, 192
   \   0000004E   6400               ORI     R16, 0x40
   \   00000050   930000C0           STS     192, R16
    152                  UCSR0B |= __BIT_MASK(TXCIE0);       // Enable TXC int.
   \   00000054   910000C1           LDS     R16, 193
   \   00000058   6400               ORI     R16, 0x40
   \   0000005A   930000C1           STS     193, R16
    153                  UART[0].RxState = SYNC;
   \   0000005E   E000               LDI     R16, 0
   \   00000060   9300....           STS     (UART + 439), R16
    154              }
    155          }
   \                     ??Int_Handler_UDRE_USART0_1:
   \   00000064   01C9               MOVW    R25:R24, R19:R18
   \   00000066   9508               RET
   \   00000068                      REQUIRE _A_UDR0
   \   00000068                      REQUIRE _A_UCSR0B
   \   00000068                      REQUIRE _A_UCSR0A
    156          
    157          
    158              #pragma vector=USART0_UDRE_vect

   \                                 In  segment CODE, align 2, keep-with-next
    159          __interrupt void IntHandler_UDRE_USART0(void) {
   \                     IntHandler_UDRE_USART0:
   \   00000000   939A               ST      -Y, R25
   \   00000002   938A               ST      -Y, R24
   \   00000004   93FA               ST      -Y, R31
   \   00000006   93EA               ST      -Y, R30
   \   00000008   923A               ST      -Y, R3
   \   0000000A   922A               ST      -Y, R2
   \   0000000C   921A               ST      -Y, R1
   \   0000000E   920A               ST      -Y, R0
   \   00000010   937A               ST      -Y, R23
   \   00000012   936A               ST      -Y, R22
   \   00000014   935A               ST      -Y, R21
   \   00000016   934A               ST      -Y, R20
   \   00000018   933A               ST      -Y, R19
   \   0000001A   932A               ST      -Y, R18
   \   0000001C   931A               ST      -Y, R17
   \   0000001E   930A               ST      -Y, R16
   \   00000020   B78F               IN      R24, 0x3F
   \   00000022   B79B               IN      R25, 0x3B
    160              OS_CallISR(Int_Handler_UDRE_USART0);
   \   00000024   ....               LDI     R16, LOW(Int_Handler_UDRE_USART0/2)
   \   00000026   ....               LDI     R17, (Int_Handler_UDRE_USART0/2) >> 8
   \   00000028   ........           CALL    OS_CallISR_Debug
    161          }
   \   0000002C   BF9B               OUT     0x3B, R25
   \   0000002E   BF8F               OUT     0x3F, R24
   \   00000030   9109               LD      R16, Y+
   \   00000032   9119               LD      R17, Y+
   \   00000034   9129               LD      R18, Y+
   \   00000036   9139               LD      R19, Y+
   \   00000038   9149               LD      R20, Y+
   \   0000003A   9159               LD      R21, Y+
   \   0000003C   9169               LD      R22, Y+
   \   0000003E   9179               LD      R23, Y+
   \   00000040   9009               LD      R0, Y+
   \   00000042   9019               LD      R1, Y+
   \   00000044   9029               LD      R2, Y+
   \   00000046   9039               LD      R3, Y+
   \   00000048   91E9               LD      R30, Y+
   \   0000004A   91F9               LD      R31, Y+
   \   0000004C   9189               LD      R24, Y+
   \   0000004E   9199               LD      R25, Y+
   \   00000050   9518               RETI
    162          // USART1

   \                                 In  segment CODE, align 2, keep-with-next
    163          void Int_Handler_RX_USART1(void) {
   \                     Int_Handler_RX_USART1:
    164          #if USE_1281_RX_INT_TASK==0
    165          
    166              if (UCSR1A & __BIT_MASK(DOR1)) {                // Overrun error?
    167              }
    168          
    169              if (UCSR1A & __BIT_MASK(FE1)) {                 // Framing error?
    170              }
    171          
    172              while (UCSR1A & __BIT_MASK(RXC1)) {                // New byte avaiable?
    173                  UART[1].pRxBuffer[UART[1].RxFirst] = UDR1;    // Read the character
    174          
    175                  if (UART[1].RxState != HANDLE) {                // ok to receive?
    176                      switch (UART[1].RxState) {                   // Yes, check state
    177                      case SYNC :
    178                          if (UART[1].pRxBuffer[UART[1].RxFirst] == ANPRO10_SYN) {
    179                              UART[1].SyncCnt++;                 // count sync
    180                              UART[1].RxFirst = 0;                 // start at start of buff
    181                          } else if ((UART[1].SyncCnt >= 2) &&
    182                                     (UART[1].pRxBuffer[UART[1].RxFirst] == ANPRO10_SOH)) {       // minimum two sync bytes
    183                              UART[1].SyncCnt = 0;                // reset counter
    184                              UART[1].RxState = HEADER;
    185                              UART[1].RxLast = 0;
    186                              UART[1].RxTimeout = RX_TO_TIME;      // reset timeout
    187                          } else {
    188                              UART[1].SyncCnt = 0;                // start over once more
    189                          }
    190                          break;
    191                      default :
    192                          if ((++UART[1].RxFirst) > RXSIZE_UART) { // Point to next location
    193                              GoToSyncUART(1);                    // go to sync mode
    194                          } else {
    195                              ReceivePacketUart(1);              // Check package
    196                          }
    197                          break;
    198                      }
    199                  }
    200              }
    201          #else
    202              while (UCSR1A & __BIT_MASK(RXC1)) {                // New byte avaiable?
   \                     ??Int_Handler_RX_USART1_0:
   \   00000000   9100....           LDS     R16, _A_UCSR1A
   \   00000004   2F10               MOV     R17, R16
   \   00000006   FF17               SBRS    R17, 7
   \   00000008   C00B               RJMP    ??Int_Handler_RX_USART1_1
    203                  UART[1].RxByte = UDR1;    // Read the character
   \   0000000A   9100....           LDS     R16, _A_UDR1
   \   0000000E   9300....           STS     (UART + 959), R16
    204                  //if (OS_IsTask(&TCB_ATMega1281RX_Driver1)) {
    205                      OS_PutMailCond1(&UART[1].RxMailBox, &UART[1].RxByte);
   \   00000012   ....               LDI     R18, LOW((UART + 959))
   \   00000014   ....               LDI     R19, HIGH((UART + 959))
   \   00000016   ....               LDI     R16, LOW((UART + 1010))
   \   00000018   ....               LDI     R17, HIGH((UART + 1010))
   \   0000001A   ........           CALL    OS_PutMailCond1
   \   0000001E   CFF0               RJMP    ??Int_Handler_RX_USART1_0
    206                  //}
    207              }
    208          #endif
    209          
    210          }
   \                     ??Int_Handler_RX_USART1_1:
   \   00000020   9508               RET
   \   00000022                      REQUIRE _A_UDR1
   \   00000022                      REQUIRE _A_UCSR1A
    211          
    212              #pragma vector=USART1_RX_vect

   \                                 In  segment CODE, align 2, keep-with-next
    213          __interrupt void IntHandler_RX_USART1(void) {
   \                     IntHandler_RX_USART1:
   \   00000000   939A               ST      -Y, R25
   \   00000002   938A               ST      -Y, R24
   \   00000004   93FA               ST      -Y, R31
   \   00000006   93EA               ST      -Y, R30
   \   00000008   923A               ST      -Y, R3
   \   0000000A   922A               ST      -Y, R2
   \   0000000C   921A               ST      -Y, R1
   \   0000000E   920A               ST      -Y, R0
   \   00000010   937A               ST      -Y, R23
   \   00000012   936A               ST      -Y, R22
   \   00000014   935A               ST      -Y, R21
   \   00000016   934A               ST      -Y, R20
   \   00000018   933A               ST      -Y, R19
   \   0000001A   932A               ST      -Y, R18
   \   0000001C   931A               ST      -Y, R17
   \   0000001E   930A               ST      -Y, R16
   \   00000020   B78F               IN      R24, 0x3F
   \   00000022   B79B               IN      R25, 0x3B
    214              OS_CallISR(Int_Handler_RX_USART1);
   \   00000024   ....               LDI     R16, LOW(Int_Handler_RX_USART1/2)
   \   00000026   ....               LDI     R17, (Int_Handler_RX_USART1/2) >> 8
   \   00000028   ........           CALL    OS_CallISR_Debug
    215          }
   \   0000002C   BF9B               OUT     0x3B, R25
   \   0000002E   BF8F               OUT     0x3F, R24
   \   00000030   9109               LD      R16, Y+
   \   00000032   9119               LD      R17, Y+
   \   00000034   9129               LD      R18, Y+
   \   00000036   9139               LD      R19, Y+
   \   00000038   9149               LD      R20, Y+
   \   0000003A   9159               LD      R21, Y+
   \   0000003C   9169               LD      R22, Y+
   \   0000003E   9179               LD      R23, Y+
   \   00000040   9009               LD      R0, Y+
   \   00000042   9019               LD      R1, Y+
   \   00000044   9029               LD      R2, Y+
   \   00000046   9039               LD      R3, Y+
   \   00000048   91E9               LD      R30, Y+
   \   0000004A   91F9               LD      R31, Y+
   \   0000004C   9189               LD      R24, Y+
   \   0000004E   9199               LD      R25, Y+
   \   00000050   9518               RETI
    216          

   \                                 In  segment CODE, align 2, keep-with-next
    217          void Int_Handler_TX_USART1(void) {
   \                     Int_Handler_TX_USART1:
    218          
    219              UCSR1B &= ~(__BIT_MASK(TXCIE1));            // transmission end, disable int.
   \   00000000   910000C9           LDS     R16, 201
   \   00000004   7B0F               ANDI    R16, 0xBF
   \   00000006   930000C9           STS     201, R16
    220              PORTE &= ~0x08;                              // TXE1 off
   \   0000000A   9873               CBI     0x0E, 0x03
    221          //    OS_StopTimer(&TimerUSART1);                    // and stop timer
    222              GoToSyncUART(1);                                    // go to sync modus for recive
   \   0000000C   E001               LDI     R16, 1
   \   0000000E   ........           CALL    GoToSyncUART
    223          }
   \   00000012   9508               RET
   \   00000014                      REQUIRE _A_UCSR1B
   \   00000014                      REQUIRE _A_PORTE
    224          
    225              #pragma vector=USART1_TX_vect

   \                                 In  segment CODE, align 2, keep-with-next
    226          __interrupt void IntHandler_TX_USART1(void) {
   \                     IntHandler_TX_USART1:
   \   00000000   939A               ST      -Y, R25
   \   00000002   938A               ST      -Y, R24
   \   00000004   93FA               ST      -Y, R31
   \   00000006   93EA               ST      -Y, R30
   \   00000008   923A               ST      -Y, R3
   \   0000000A   922A               ST      -Y, R2
   \   0000000C   921A               ST      -Y, R1
   \   0000000E   920A               ST      -Y, R0
   \   00000010   937A               ST      -Y, R23
   \   00000012   936A               ST      -Y, R22
   \   00000014   935A               ST      -Y, R21
   \   00000016   934A               ST      -Y, R20
   \   00000018   933A               ST      -Y, R19
   \   0000001A   932A               ST      -Y, R18
   \   0000001C   931A               ST      -Y, R17
   \   0000001E   930A               ST      -Y, R16
   \   00000020   B78F               IN      R24, 0x3F
   \   00000022   B79B               IN      R25, 0x3B
    227              OS_CallISR(Int_Handler_TX_USART1);
   \   00000024   ....               LDI     R16, LOW(Int_Handler_TX_USART1/2)
   \   00000026   ....               LDI     R17, (Int_Handler_TX_USART1/2) >> 8
   \   00000028   ........           CALL    OS_CallISR_Debug
    228          }
   \   0000002C   BF9B               OUT     0x3B, R25
   \   0000002E   BF8F               OUT     0x3F, R24
   \   00000030   9109               LD      R16, Y+
   \   00000032   9119               LD      R17, Y+
   \   00000034   9129               LD      R18, Y+
   \   00000036   9139               LD      R19, Y+
   \   00000038   9149               LD      R20, Y+
   \   0000003A   9159               LD      R21, Y+
   \   0000003C   9169               LD      R22, Y+
   \   0000003E   9179               LD      R23, Y+
   \   00000040   9009               LD      R0, Y+
   \   00000042   9019               LD      R1, Y+
   \   00000044   9029               LD      R2, Y+
   \   00000046   9039               LD      R3, Y+
   \   00000048   91E9               LD      R30, Y+
   \   0000004A   91F9               LD      R31, Y+
   \   0000004C   9189               LD      R24, Y+
   \   0000004E   9199               LD      R25, Y+
   \   00000050   9518               RETI
    229          

   \                                 In  segment CODE, align 2, keep-with-next
    230          void Int_Handler_UDRE_USART1(void) {
   \                     Int_Handler_UDRE_USART1:
   \   00000000   019C               MOVW    R19:R18, R25:R24
    231          
    232              if (UART[1].TxCount-- > 0) {
   \   00000002   ....               LDI     R30, LOW((UART + 791))
   \   00000004   ....               LDI     R31, HIGH((UART + 791))
   \   00000006   8100               LD      R16, Z
   \   00000008   8111               LDD     R17, Z+1
   \   0000000A   01C8               MOVW    R25:R24, R17:R16
   \   0000000C   9701               SBIW    R25:R24, 1
   \   0000000E   ....               LDI     R30, LOW((UART + 791))
   \   00000010   ....               LDI     R31, HIGH((UART + 791))
   \   00000012   8380               ST      Z, R24
   \   00000014   8391               STD     Z+1, R25
   \   00000016   2B01               OR      R16, R17
   \   00000018   F099               BREQ    ??Int_Handler_UDRE_USART1_0
    233                  UDR1 = UART[1].pTxBuffer[UART[1].TxLast];     // Send a character
   \   0000001A   ....               LDI     R30, LOW((UART + 789))
   \   0000001C   ....               LDI     R31, HIGH((UART + 789))
   \   0000001E   8100               LD      R16, Z
   \   00000020   8111               LDD     R17, Z+1
   \   00000022   01F8               MOVW    R31:R30, R17:R16
   \   00000024   ....               SUBI    R30, LOW((-(UART + 512) & 0xFFFF))
   \   00000026   ....               SBCI    R31, HIGH((-(UART + 512) & 0xFFFF))
   \   00000028   8100               LD      R16, Z
   \   0000002A   9300....           STS     _A_UDR1, R16
    234                  UART[1].TxLast++;
   \   0000002E   ....               LDI     R30, LOW((UART + 789))
   \   00000030   ....               LDI     R31, HIGH((UART + 789))
   \   00000032   8100               LD      R16, Z
   \   00000034   8111               LDD     R17, Z+1
   \   00000036   5F0F               SUBI    R16, 255
   \   00000038   4F1F               SBCI    R17, 255
   \   0000003A   8300               ST      Z, R16
   \   0000003C   8311               STD     Z+1, R17
   \   0000003E   C00F               RJMP    ??Int_Handler_UDRE_USART1_1
    235              } else {
    236                  UCSR1B &= ~(__BIT_MASK(UDRIE1));            // transmission end, disable int.
   \                     ??Int_Handler_UDRE_USART1_0:
   \   00000040   910000C9           LDS     R16, 201
   \   00000044   7D0F               ANDI    R16, 0xDF
   \   00000046   930000C9           STS     201, R16
    237                  UCSR1A |= (__BIT_MASK(TXC1));               // Clear int bit in TXC.
   \   0000004A   910000C8           LDS     R16, 200
   \   0000004E   6400               ORI     R16, 0x40
   \   00000050   930000C8           STS     200, R16
    238                  UCSR1B |= __BIT_MASK(TXCIE1);       // Enable TXC int.
   \   00000054   910000C9           LDS     R16, 201
   \   00000058   6400               ORI     R16, 0x40
   \   0000005A   930000C9           STS     201, R16
    239              }
    240          }
   \                     ??Int_Handler_UDRE_USART1_1:
   \   0000005E   01C9               MOVW    R25:R24, R19:R18
   \   00000060   9508               RET
   \   00000062                      REQUIRE _A_UDR1
   \   00000062                      REQUIRE _A_UCSR1B
   \   00000062                      REQUIRE _A_UCSR1A
    241          
    242              #pragma vector=USART1_UDRE_vect

   \                                 In  segment CODE, align 2, keep-with-next
    243          __interrupt void IntHandler_UDRE_USART1(void) {
   \                     IntHandler_UDRE_USART1:
   \   00000000   939A               ST      -Y, R25
   \   00000002   938A               ST      -Y, R24
   \   00000004   93FA               ST      -Y, R31
   \   00000006   93EA               ST      -Y, R30
   \   00000008   923A               ST      -Y, R3
   \   0000000A   922A               ST      -Y, R2
   \   0000000C   921A               ST      -Y, R1
   \   0000000E   920A               ST      -Y, R0
   \   00000010   937A               ST      -Y, R23
   \   00000012   936A               ST      -Y, R22
   \   00000014   935A               ST      -Y, R21
   \   00000016   934A               ST      -Y, R20
   \   00000018   933A               ST      -Y, R19
   \   0000001A   932A               ST      -Y, R18
   \   0000001C   931A               ST      -Y, R17
   \   0000001E   930A               ST      -Y, R16
   \   00000020   B78F               IN      R24, 0x3F
   \   00000022   B79B               IN      R25, 0x3B
    244              OS_CallISR(Int_Handler_UDRE_USART1);
   \   00000024   ....               LDI     R16, LOW(Int_Handler_UDRE_USART1/2)
   \   00000026   ....               LDI     R17, (Int_Handler_UDRE_USART1/2) >> 8
   \   00000028   ........           CALL    OS_CallISR_Debug
    245          }
   \   0000002C   BF9B               OUT     0x3B, R25
   \   0000002E   BF8F               OUT     0x3F, R24
   \   00000030   9109               LD      R16, Y+
   \   00000032   9119               LD      R17, Y+
   \   00000034   9129               LD      R18, Y+
   \   00000036   9139               LD      R19, Y+
   \   00000038   9149               LD      R20, Y+
   \   0000003A   9159               LD      R21, Y+
   \   0000003C   9169               LD      R22, Y+
   \   0000003E   9179               LD      R23, Y+
   \   00000040   9009               LD      R0, Y+
   \   00000042   9019               LD      R1, Y+
   \   00000044   9029               LD      R2, Y+
   \   00000046   9039               LD      R3, Y+
   \   00000048   91E9               LD      R30, Y+
   \   0000004A   91F9               LD      R31, Y+
   \   0000004C   9189               LD      R24, Y+
   \   0000004E   9199               LD      R25, Y+
   \   00000050   9518               RETI

   \                                 In  segment INTVEC, offset 0x64, root
   \                     `??IntHandler_RX_USART0::??INTVEC 100`:
   \   00000064   ........           JMP     IntHandler_RX_USART0

   \                                 In  segment INTVEC, offset 0x68, root
   \                     `??IntHandler_UDRE_USART0::??INTVEC 104`:
   \   00000068   ........           JMP     IntHandler_UDRE_USART0

   \                                 In  segment INTVEC, offset 0x6c, root
   \                     `??IntHandler_TX_USART0::??INTVEC 108`:
   \   0000006C   ........           JMP     IntHandler_TX_USART0

   \                                 In  segment INTVEC, offset 0x90, root
   \                     `??IntHandler_RX_USART1::??INTVEC 144`:
   \   00000090   ........           JMP     IntHandler_RX_USART1

   \                                 In  segment INTVEC, offset 0x94, root
   \                     `??IntHandler_UDRE_USART1::??INTVEC 148`:
   \   00000094   ........           JMP     IntHandler_UDRE_USART1

   \                                 In  segment INTVEC, offset 0x98, root
   \                     `??IntHandler_TX_USART1::??INTVEC 152`:
   \   00000098   ........           JMP     IntHandler_TX_USART1

   \                                 In  segment NEAR_ID, align 1, keep-with-next
   \                     `?<Initializer for <Constant "ATMega1281 RX Dri`:
   \   00000000   5441654D6167       DC8 "ATMega1281 RX Driver0"
   \              323131385220
   \              205872447669
   \              72650030    

   \                                 In  segment NEAR_ID, align 1, keep-with-next
   \                     `?<Initializer for <Constant "ATMega1281 RX Dri_1`:
   \   00000000   5441654D6167       DC8 "ATMega1281 RX Driver1"
   \              323131385220
   \              205872447669
   \              72650031    

   \                                 In  segment NEAR_I, align 1, keep-with-next
   \   00000000                      REQUIRE `?<Segment init: NEAR_I>`
   \                     `?<Constant "ATMega1281 RX Driver0">`:
   \   00000000                      DS8 22
   \   00000016                      REQUIRE `?<Initializer for <Constant "ATMega1281 RX Dri`

   \                                 In  segment NEAR_I, align 1, keep-with-next
   \   00000000                      REQUIRE `?<Segment init: NEAR_I>`
   \                     `?<Constant "ATMega1281 RX Driver1">`:
   \   00000000                      DS8 22
   \   00000016                      REQUIRE `?<Initializer for <Constant "ATMega1281 RX Dri_1`
    246          
    247          #endif /* USE_MODBUS_PROTOCOL == 0 */
    248          
    249          
    250          

   Maximum stack usage in bytes:

   CSTACK RSTACK Function
   ------ ------ --------
      3      2   ATMega1281_RX_driver_task
        3      2   -> Init_USART
        3      2   -> _ATMega1281_irq_handler
      8      2   ATMega1281_driver_task_init
        0      2   -> OS_CreateTaskEx_D
     16      2   IntHandler_RX_USART0
       16      2   -> OS_CallISR_Debug
     16      2   IntHandler_RX_USART1
       16      2   -> OS_CallISR_Debug
     16      2   IntHandler_TX_USART0
       16      2   -> OS_CallISR_Debug
     16      2   IntHandler_TX_USART1
       16      2   -> OS_CallISR_Debug
     16      2   IntHandler_UDRE_USART0
       16      2   -> OS_CallISR_Debug
     16      2   IntHandler_UDRE_USART1
       16      2   -> OS_CallISR_Debug
      0      2   Int_Handler_RX_USART0
        0      2   -> OS_PutMailCond1
      0      2   Int_Handler_RX_USART1
        0      2   -> OS_PutMailCond1
      0      2   Int_Handler_TX_USART0
        0      2   -> GoToSyncUART
      0      2   Int_Handler_TX_USART1
        0      2   -> GoToSyncUART
      0      2   Int_Handler_UDRE_USART0
      0      2   Int_Handler_UDRE_USART1
      5      2   _ATMega1281_irq_handler
        5      2   -> GoToSyncUART
        5      2   -> OS_GetMail1
        5      2   -> ReceivePacketUart


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
      22  ?<Constant "ATMega1281 RX Driver0">
      22  ?<Constant "ATMega1281 RX Driver1">
      22  ?<Initializer for <Constant "ATMega1281 RX Dri
      22  ?<Initializer for <Constant "ATMega1281 RX Dri_1
      28  ATMega1281_RX_driver_task
     102  ATMega1281_driver_task_init
      82  IntHandler_RX_USART0
       4  IntHandler_RX_USART0::??INTVEC 100
      82  IntHandler_RX_USART1
       4  IntHandler_RX_USART1::??INTVEC 144
      82  IntHandler_TX_USART0
       4  IntHandler_TX_USART0::??INTVEC 108
      82  IntHandler_TX_USART1
       4  IntHandler_TX_USART1::??INTVEC 152
      82  IntHandler_UDRE_USART0
       4  IntHandler_UDRE_USART0::??INTVEC 104
      82  IntHandler_UDRE_USART1
       4  IntHandler_UDRE_USART1::??INTVEC 148
      42  Int_Handler_RX_USART0
      34  Int_Handler_RX_USART1
      20  Int_Handler_TX_USART0
      20  Int_Handler_TX_USART1
     104  Int_Handler_UDRE_USART0
      98  Int_Handler_UDRE_USART1
      33  TCB_ATMega1281RX_Driver0
      33  TCB_ATMega1281RX_Driver1
     466  _ATMega1281_irq_handler
       1  _A_PORTE
       1  _A_UCSR0A
       1  _A_UCSR0B
       1  _A_UCSR1A
       1  _A_UCSR1B
       1  _A_UDR0
       1  _A_UDR1
     600  stack1
     600  stack2
      14  -- Other

 
     7 bytes in segment ABSOLUTE
 1 406 bytes in segment CODE
    14 bytes in segment INITTAB
    24 bytes in segment INTVEC
    44 bytes in segment NEAR_I
    44 bytes in segment NEAR_ID
 1 266 bytes in segment NEAR_Z
 
 1 450 bytes of CODE memory (+ 38 bytes shared)
 1 310 bytes of DATA memory (+  7 bytes shared)

Errors: none
Warnings: none
